<!DOCTYPE html>
<html lang="it">
<head>
 <link rel="icon" href="favicon.ico" type="image/x-icon">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<!-- ==================== META TAG PRINCIPALI ==================== -->
<title>Tennis Cup 2025 | Circuito Amatoriale di Tornei tra Amici</title>
<meta name="description" content="Classifiche ufficiali, calendari tornei e risultati del circuito Tennis Cup 2025. Scopri THE SINNER, HEAT CUP, ORANGE TOURNAMENT e SNOW SLAM a Legnago.">
<meta name="keywords" content="tennis cup, torneo tennis, classifica tennis, slam tennis, tennis amatoriale, tennis tra amici, circuito tennis, ranking tennis, tennis 2025, tennis legnago">
<meta name="author" content="Tennis Cup Organization">
<meta name="robots" content="index, follow, max-image-preview:large">

<!-- ==================== OPEN GRAPH / SOCIAL ==================== -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://tenniscup.org/">
<meta property="og:title" content="Tennis Cup 2025 | Circuito Amatoriale di Tornei">
<meta property="og:description" content="Classifiche ufficiali, calendari tornei e risultati del circuito Tennis Cup 2025. Gioca con noi a Legnago!">
<meta property="og:image" content="https://tenniscup.org/img/logos/tenniscup-social.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:site_name" content="Tennis Cup">
<meta property="og:locale" content="it_IT">

<!-- ==================== TWITTER ==================== -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://tenniscup.org/">
<meta property="twitter:title" content="Tennis Cup 2025 | Circuito Amatoriale di Tornei">
<meta property="twitter:description" content="Classifiche ufficiali, calendari tornei e risultati del circuito Tennis Cup 2025. Gioca con noi a Legnago!">
<meta property="twitter:image" content="https://tenniscup.org/img/logos/tenniscup-social.jpg">

<!-- ==================== GEO & LOCAL SEO ==================== -->
<meta name="geo.region" content="IT-VR">
<meta name="geo.placename" content="Legnago">
<meta name="geo.position" content="45.1910;11.3098">
<meta name="ICBM" content="45.1910, 11.3098">

<!-- ==================== SCHEMA.ORG ==================== -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SportsOrganization",
  "name": "Tennis Cup",
  "url": "https://tenniscup.org",
  "logo": "https://tenniscup.org/img/logos/tenniscup-social.jpg",
  "description": "Circuito amatoriale di tornei di tennis a Legnago",
  "foundingDate": "2025",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Via del Tennis 1",
    "addressLocality": "Legnago",
    "addressRegion": "Veneto",
    "postalCode": "37045",
    "addressCountry": "IT"
  },
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "Tornei Tennis",
    "itemListElement": [
      {
        "@type": "OfferCatalog",
        "name": "THE SINNER",
        "itemListElement": {
          "@type": "Offer",
          "name": "Torneo di Primavera"
        }
      },
      {
        "@type": "OfferCatalog",
        "name": "HEAT CUP",
        "itemListElement": {
          "@type": "Offer",
          "name": "Torneo Estivo"
        }
      },
	  {
        "@type": "OfferCatalog",
        "name": "ORANGE TOURNAMENT",
        "itemListElement": {
          "@type": "Offer",
          "name": "Torneo Autunnale"
        }
      },
	  {
        "@type": "OfferCatalog",
        "name": " SNOW SLAM",
        "itemListElement": {
          "@type": "Offer",
          "name": "Torneo Invernale"
        }
      }
    ]
  }
}
</script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
	
  .click-feedback {
    animation: click-feedback 0.3s ease;
  }
  
  @keyframes click-feedback {
    0% { transform: scale(1); }
    50% { transform: scale(0.98); }
    100% { transform: scale(1); }
  }
  
  /* Effetto per mobile (vibrazione) */
  @media (hover: none) and (pointer: coarse) {
    .click-feedback {
      animation: none;
    }
  }	
   
  :root {
    --green: #38a169;
    --green-light: #68d391;
    --gray-light: #f7fafc;
    --gray-medium: #a0aec0;
    --gray-dark: #2d3748;
    --blue: #4299e1;
    --shadow: rgba(0,0,0,0.1);
    --dark-bg: #1a202c;
    --dark-text: #e2e8f0;
    --dark-card: #2d3748;
  }

  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: #f0f7f4;
    color: var(--gray-dark);
    overflow-x: hidden;
    transition: background 0.3s ease, color 0.3s ease;
  }

  body.dark-mode {
    background: var(--dark-bg);
    color: var(--dark-text);
  }

  header {
    background: linear-gradient(90deg, #4caf50, #81c784);
    padding: 1.5rem 2rem;
    text-align: center;
    color: white;
    font-weight: 700;
    font-size: 2.5rem;
    letter-spacing: 0.1em;
    text-shadow: 1px 1px 4px rgba(0,0,0,0.2);
    user-select: none;
    position: relative;
  }

  body.dark-mode header {
    background: linear-gradient(90deg, #2c7d36, #4e9f5a);
  }

  header span.edition-select-container {
    position: absolute;
    top: 50%;
    right: 1.5rem;
    transform: translateY(-50%);
    font-weight: 500;
    font-size: 1rem;
    color: #eef7ee;
  }
  header span.edition-select-container select {
    margin-left: 0.5rem;
    font-weight: 600;
    border-radius: 5px;
    border: none;
    padding: 3px 8px;
    font-family: 'Poppins', sans-serif;
    cursor: pointer;
    background: white;
  }

  .header-controls {
    position: absolute;
    top: 50%;
    left: 1.5rem;
    transform: translateY(-50%);
    display: flex;
    gap: 0.8rem;
  }

  .header-btn {
    background: rgba(255,255,255,0.2);
    border: none;
    border-radius: 5px;
    color: white;
    padding: 0.4rem 0.8rem;
    font-family: 'Poppins', sans-serif;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  .header-btn:hover {
    background: rgba(255,255,255,0.3);
  }

  main {
    max-width: 1000px;
    margin: 2rem auto 4rem;
    padding: 0 1rem;
  }

  section {
    margin-bottom: 3.5rem;
  }

  h2 {
    font-weight: 700;
    font-size: 2rem;
    margin-bottom: 1.5rem;
    color: var(--green-dark, #276749);
    text-align: center;
    letter-spacing: 0.05em;
  }

  body.dark-mode h2 {
    color: var(--green-light);
  }

/* Alternativa: vicino al titolo */
.tennis-ball-container {
  display: inline-block;
  margin-left: 15px;
  vertical-align: middle;
  position: relative;
  top: -3px;
}

.tennis-ball {
  width: 30px;
  height: 30px;
  background-color: #ffeb3b;
  background-image: 
    radial-gradient(circle at 30% 30%, #fff, transparent 60%),
    linear-gradient(45deg, transparent 40%, #fff 40%, #fff 60%, transparent 60%);
  border-radius: 50%;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  animation: bounce 1s infinite alternate;
}

@keyframes bounce {
  0% {
    transform: translateY(0) rotate(0deg);
  }
  100% {
    transform: translateY(-15px) rotate(30deg);
  }
}

/* Versione dark mode */
body.dark-mode .tennis-ball {
  filter: brightness(0.9);
}
  
  /* CLASSIFICA */

  #classifica-bars {
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
    max-width: 600px;
    margin: 0 auto;
  }

  #classifica-bars div[role="listitem"] {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    cursor: pointer;
    transition: transform 0.2s ease;
  }
  #classifica-bars div[role="listitem"]:hover {
    transform: translateX(5px);
  }

  .name {
    font-weight: 600;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    user-select: none;
  }

  .last-slam-points {
    font-weight: 500;
    font-size: 0.9rem;
    color: var(--green);
  }

  .bar-container {
    background: var(--gray-light);
    border-radius: 30px;
    height: 28px;
    overflow: hidden;
    position: relative;
  }

  body.dark-mode .bar-container {
    background: #4a5568;
  }

  .bar-fill {
    height: 100%;
    width: 0;
    background: var(--green);
    border-radius: 30px 0 0 30px;
    transition: width 1.2s ease;
  }

  .points {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    font-weight: 700;
    color: white;
    text-shadow: 0 0 2px rgba(0,0,0,0.6);
    pointer-events: none;
    -webkit-text-stroke: 1px black;
  }

  /* CALENDARIO */

  #calendario .grid {
    display: grid;
    gap: 1.8rem;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    max-width: 900px;
    margin: 0 auto;
  }

  .tournament-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 18px var(--shadow);
    padding: 1rem;
    cursor: pointer;
    display: flex;
    gap: 1rem;
    align-items: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    user-select: none;
    position: relative;
  }

  body.dark-mode .tournament-card {
    background: var(--dark-card);
    color: var(--dark-text);
  }

  .tournament-card:focus,
  .tournament-card:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 22px rgba(0,0,0,0.2);
    outline: none;
  }

  .tournament-logo {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    object-fit: contain;
    box-shadow: 0 0 8px transparent;
    transition: box-shadow 0.3s ease, transform 0.3s ease;
  }
  .tournament-card:hover .tournament-logo,
  .tournament-card:focus .tournament-logo {
    box-shadow: 0 0 12px var(--green-light);
    transform: scale(1.15);
  }

  .tournament-info-wrapper {
    flex: 1;
  }
  .tournament-info-wrapper div {
    user-select: none;
  }

  .tournament-info-wrapper strong {
    font-weight: 700;
  }

  .winner-check {
    position: absolute;
    top: 10px;
    right: 10px;
    color: #38a169;
    font-size: 1.5rem;
    pointer-events: none;
  }

  /* PLAYER STATS PAGE */
  .player-stats-container {
    max-width: 800px;
    margin: 2rem auto;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 18px var(--shadow);
  }

  body.dark-mode .player-stats-container {
    background: var(--dark-card);
  }

  .player-header {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .player-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid var(--green);
  }
   .player-avatar:hover {
	cursor: pointer;
  }

  .player-name {
    font-size: 2rem;
    font-weight: 700;
    margin: 0;
  }

  .back-btn {
    display: inline-block;
    margin-bottom: 1.5rem;
    background: var(--green);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    text-decoration: none;
    font-weight: 600;
    transition: background 0.3s ease;
  }
  .back-btn:hover {
    background: var(--green-light);
  }

  .stats-section {
    margin-bottom: 2rem;
  }

  .stats-section h3 {
    border-bottom: 2px solid var(--green);
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
  }

  .stat-card {
    background: var(--gray-light);
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
  }

  body.dark-mode .stat-card {
    background: #4a5568;
  }

  .stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--green);
    margin: 0.5rem 0;
  }

  .stat-label {
    font-size: 0.9rem;
    color: var(--gray-dark);
  }

  body.dark-mode .stat-label {
    color: var(--dark-text);
  }

  .trophies-container {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .trophy {
    background: var(--gray-light);
    padding: 1rem;
    border-radius: 8px;
    flex: 1;
    min-width: 200px;
    position: relative;
  }

  body.dark-mode .trophy {
    background: #4a5568;
  }

  .trophy-icon {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 1.5rem;
    color: gold;
  }

  .filter-controls {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .filter-btn {
    background: var(--gray-light);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  body.dark-mode .filter-btn {
    background: #4a5568;
    color: var(--dark-text);
  }

  .filter-btn.active {
    background: var(--green);
    color: white;
  }

  /* SIMULATOR */
  .simulator-container {
    max-width: 600px;
    margin: 2rem auto;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 18px var(--shadow);
  }

  body.dark-mode .simulator-container {
    background: var(--dark-card);
  }

  .simulator-select {
    width: 100%;
    padding: 0.5rem;
    margin-bottom: 1rem;
    border-radius: 5px;
    border: 1px solid var(--gray-medium);
    font-family: 'Poppins', sans-serif;
  }

  body.dark-mode .simulator-select {
    background: #4a5568;
    color: var(--dark-text);
    border-color: #718096;
  }

  .simulate-btn {
    background: var(--green);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s ease;
  }
  .simulate-btn:hover {
    background: var(--green-light);
  }

  .simulation-result {
    margin-top: 1rem;
    padding: 1rem;
    background: var(--gray-light);
    border-radius: 8px;
    display: none;
  }

  body.dark-mode .simulation-result {
    background: #4a5568;
  }

  /* NEWS SECTION */
  .news-container {
    max-width: 800px;
    margin: 0 auto;
  }

  .news-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px var(--shadow);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
  }

  body.dark-mode .news-card {
    background: var(--dark-card);
  }

  .news-title {
    font-size: 1.3rem;
    font-weight: 700;
    margin-top: 0;
    color: var(--green);
  }

  .news-date {
    color: var(--gray-medium);
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }
  
  .show-all-btn {
    margin-top: 1rem;
    background: var(--blue);
    color: white;
    border: none;
    border-radius: 7px;
    padding: 0.5rem 1rem;
    cursor: pointer;
    font-weight: 700;
    letter-spacing: 0.05em;
    transition: background-color 0.3s ease;
  }
  .show-all-btn:hover,
  .show-all-btn:focus {
    background-color: #63b3ed;
    outline: none;
  }
  
  #showAllNewsBtn {
    display: none; /* Nascosto inizialmente */
    margin: 1rem auto;
  }
  
  .gallery-controls, .news-controls {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 1rem;
}

.reduce-btn {
  background: var(--green);
  color: white;
  border: none;
  border-radius: 7px;
  padding: 0.5rem 1rem;
  cursor: pointer;
  font-weight: 700;
  letter-spacing: 0.05em;
  transition: background-color 0.3s ease;
}

.reduce-btn:hover,
.reduce-btn:focus {
  background-color: var(--green-light);
  outline: none;
}

  /* CONTACT FORM */
  .contact-container {
    max-width: 600px;
    margin: 2rem auto;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 18px var(--shadow);
  }

  body.dark-mode .contact-container {
    background: var(--dark-card);
  }

  .form-group {
    margin-bottom: 1rem;
  }

  .form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
  }

  .form-input,
  .form-textarea {
    width: 100%;
    padding: 0.5rem;
    border-radius: 5px;
    border: 1px solid var(--gray-medium);
    font-family: 'Poppins', sans-serif;
  }

  body.dark-mode .form-input,
  body.dark-mode .form-textarea {
    background: #4a5568;
    color: var(--dark-text);
    border-color: #718096;
  }

  .form-textarea {
    min-height: 100px;
  }

  .submit-btn {
    background: var(--green);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s ease;
  }
  .submit-btn:hover {
    background: var(--green-light);
  }

  /* POPUP */

  #popup {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    width: 320px;
    max-width: 90vw;
    background: white;
    border-radius: 15px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.25);
    padding: 1.5rem 2rem;
    z-index: 100;
    opacity: 0;
    pointer-events: none;
    transform: translateY(40px);
    transition: opacity 0.4s ease, transform 0.4s ease;
  }

  body.dark-mode #popup {
    background: var(--dark-card);
  }

  #popup.active {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
  }

  #popup h3 {
    margin-top: 0;
    font-weight: 700;
    font-size: 1.5rem;
    margin-bottom: 0.6rem;
    color: var(--green);
  }

  #popup p {
    margin: 0.25rem 0;
    font-size: 0.9rem;
  }

  #popup button {
    margin-top: 1rem;
    background: var(--green);
    color: white;
    border: none;
    border-radius: 7px;
    padding: 0.5rem 1rem;
    cursor: pointer;
    font-weight: 700;
    letter-spacing: 0.05em;
    transition: background-color 0.3s ease;
  }
  #popup button:hover,
  #popup button:focus {
    background-color: var(--green-light);
    outline: none;
  }

  #popup-close {
    position: absolute;
    top: 8px;
    right: 8px;
    background: transparent;
    border: none;
    font-size: 1.2rem;
    color: var(--gray-medium);
    cursor: pointer;
    transition: color 0.3s ease;
  }
  #popup-close:hover,
  #popup-close:focus {
    color: var(--green);
    outline: none;
  }

  #popup-details {
    margin-top: 1rem;
    max-height: 33vh;
    overflow-y: auto;
    font-size: 0.9rem;
    border-top: 1px solid #ddd;
    padding-top: 1rem;
    line-height: 1.6;
}

body.dark-mode #popup-details {
    border-top-color: #4a5568;
}
  
  #standingsBtn {
	  margin-top: 1rem;
	  background: var(--blue);
	  color: white;
	  border: none;
	  border-radius: 7px;
	  padding: 0.5rem 1rem;
	  cursor: pointer;
	  font-weight: 700;
	  letter-spacing: 0.05em;
	  transition: background-color 0.3s ease;
	  margin-left: 0.5rem;
	}
	#standingsBtn:hover,
	#standingsBtn:focus {
	  background-color: #63b3ed;
	  outline: none;
	}

  /* GALLERIA */

  #galleria {
    max-width: 900px;
    margin: 0 auto;
    text-align: center;
  }

  #galleria .thumbs {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  #galleria .thumbs img {
    width: 150px;
    height: 100px;
    object-fit: cover;
    border-radius: 10px;
    box-shadow: 0 4px 8px var(--shadow);
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  #galleria .thumbs img:hover,
  #galleria .thumbs img:focus {
    transform: scale(1.05);
    box-shadow: 0 6px 14px rgba(0,0,0,0.3);
    outline: none;
  }

  #galleria .show-all-btn {
    margin-top: 1rem;
    background: var(--blue);
    color: white;
    border: none;
    border-radius: 7px;
    padding: 0.5rem 1rem;
    cursor: pointer;
    font-weight: 700;
    letter-spacing: 0.05em;
    transition: background-color 0.3s ease;
  }
  #galleria .show-all-btn:hover,
  #galleria .show-all-btn:focus {
    background-color: #63b3ed;
    outline: none;
  }
  /* Stili video galleria */
.video-thumb {
    position: relative;
    width: 150px;
    height: 100px;
    cursor: pointer;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 8px var(--shadow);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}


.video-poster {
    width: 100%;
    height: 100%;
    object-fit: cover;
}


.play-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 24px;
    color: white;
    text-shadow: 0 0 5px rgba(0,0,0,0.7);
    background: rgba(0,0,0,0.5);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.video-thumb:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 14px rgba(0,0,0,0.3);
}

  /* LIGHTBOX */
  
  /* Avatar Lightbox */
#avatar-lightbox {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

#avatar-lightbox.active {
    display: flex;
}

#avatar-lightbox img {
    max-width: 90vw;
    max-height: 90vh;
    border-radius: 50%;
    border: 4px solid var(--green);
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
}

#avatar-lightbox-close {
    position: absolute;
    top: 20px;
    right: 20px;
    font-size: 2rem;
    color: white;
    background: transparent;
    border: none;
    cursor: pointer;
}
  
 #lightbox {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

#lightbox.active {
    display: flex;
}

#lightbox video, 
#lightbox img {
    max-width: 90vw;
    max-height: 90vh;
    border-radius: 8px;
}

#lightbox-close {
    position: absolute;
    top: 20px;
    right: 20px;
    font-size: 2rem;
    color: white;
    background: transparent;
    border: none;
    cursor: pointer;
}

  /* FOOTER */

  footer {
    text-align: center;
    padding: 1.5rem 1rem;
    background: #2f855a;
    color: white;
    font-weight: 600;
    letter-spacing: 0.05em;
    font-size: 1rem;
    user-select: none;
  }

  body.dark-mode footer {
    background: #22543d;
  }

  /* Responsive */
  @media (max-width: 900px) {
    #calendario .grid {
      grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 600px) {
  header {
    padding: 0.8rem;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .header-title-container {
    position: relative;
    flex-direction: column;
    align-items: center;
    display: flex;
    margin-bottom: 0.5rem;
  }

  .header-title-container span {
    font-size: 1.6rem;
    margin-bottom: 0.3rem;
  }

  .tennis-ball-container {
    position: absolute;
    top: 4.8rem;   /* regola se serve, dipende dal font */
    left: -1.2rem;  /* sposta verso sinistra */
    width: 40px;
    height: 40px;
  }

  .edition-select-container {
    order: 2;
    margin: 0.3rem 0;
    font-size: 0.9rem;
    position: static;
    transform: none;
  }

  .header-controls {
    order: 3;
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
    width: 100%;
    position: static;
    transform: none;
    flex-wrap: wrap;
  }

  .header-btn {
    padding: 0.4rem 0.7rem;
    font-size: 0.85rem;
    min-width: 100px;
    text-align: center;
    flex: 1;
  }

  #editionSelect {
    font-size: 0.85rem;
    padding: 0.2rem 0.4rem;
  }

    #galleria .thumbs {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 0.8rem;
        padding: 0 0.5rem;
    }
    
    #galleria .thumbs img,
    #galleria .video-thumb {
        width: 100%;
        height: 120px;
        max-height: none;
        object-fit: cover;
    }
    
    .gallery-controls {
        flex-direction: column;
        align-items: center;
    }
    
    .show-all-btn, .reduce-btn {
        width: 80%;
        margin: 0.3rem 0;
    }

    #classifica-bars {
        max-width: 100%;
    }
    
    #calendario .grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    #popup {
        width: 90vw;
        bottom: 1rem;
        right: 50%;
        transform: translate(50%,40px);
    }
    
    #popup.active {
        transform: translate(50%,0);
    }
    
    #galleria .thumbs img {
        width: 100%;
        height: auto;
        max-height: 200px;
    }
    
    .player-header {
        flex-direction: column;
        text-align: center;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 400px) {
    #galleria .thumbs {
        grid-template-columns: 1fr;
    }
    
    .header-controls {
        flex-wrap: wrap;
    }
    
    .header-btn {
        flex: 1 0 45%;
        margin: 0.2rem;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
}
.position-inputs {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.position-input {
  display: flex;
  align-items: center;
}

.position-input label {
  width: 30px;
  margin-right: 10px;
  font-weight: 600;
}

.position-select {
  flex: 1;
  padding: 0.3rem;
}
/* FAQ Styles */
.faq-container {
  max-width: 800px;
  margin: 0 auto;
  padding: 0 1rem;
}

.faq-item {
  margin-bottom: 1rem;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 8px var(--shadow);
  background: white;
  transition: transform 0.3s ease;
}

body.dark-mode .faq-item {
  background: var(--dark-card);
}

.faq-question {
  width: 100%;
  padding: 1.2rem 1.5rem;
  text-align: left;
  background: var(--gray-light);
  border: none;
  font-family: 'Poppins', sans-serif;
  font-weight: 600;
  font-size: 1.1rem;
  color: var(--gray-dark);
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  transition: background 0.3s ease;
}

body.dark-mode .faq-question {
  background: #4a5568;
  color: var(--dark-text);
}

.faq-question:hover {
  background: var(--green-light);
  color: white;
}

.faq-icon {
  font-size: 1.5rem;
  transition: transform 0.3s ease;
}

.faq-answer {
  padding: 0 1.5rem;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease, padding 0.3s ease;
  background: white;
}

body.dark-mode .faq-answer {
  background: var(--dark-card);
}

.faq-answer p, .faq-answer ul {
  margin: 0;
  padding: 0.5rem 0 1.5rem;
  line-height: 1.6;
  color: var(--gray-dark);
}

body.dark-mode .faq-answer p, 
body.dark-mode .faq-answer ul {
  color: var(--dark-text);
}

.faq-item.active .faq-answer {
  max-height: 500px;
  padding: 0 1.5rem;
}

.faq-item.active .faq-icon {
  transform: rotate(45deg);
}

.faq-item.active .faq-question {
  background: var(--green);
  color: white;
}

/* Responsive */
@media (max-width: 600px) {
  .faq-question {
    padding: 1rem;
    font-size: 1rem;
  }
  
  .faq-answer {
    padding: 0 1rem;
  }
  
  .faq-item.active .faq-answer {
    padding: 0 1rem;
  }
}
footer {
  background: linear-gradient(90deg, #2f855a, #38a169);
  color: white;
  padding: 2rem 1rem;
  font-family: 'Poppins', sans-serif;
}

body.dark-mode footer {
  background: linear-gradient(90deg, #22543d, #276749);
}

.footer-container {
  max-width: 1200px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 2rem;
  padding: 1rem;
}

.about, 
.footer-links, 
.footer-map {
  margin-bottom: 1.5rem;
}

footer h3 {
  font-size: 1.2rem;
  margin-bottom: 1rem;
  color: #ffffff;
  border-bottom: 2px solid rgba(255,255,255,0.2);
  padding-bottom: 0.5rem;
}

footer p {
  margin: 0.5rem 0;
  line-height: 1.6;
}

.footer-links ul {
  list-style: none;
  padding: 0;
}

.footer-links li {
  margin-bottom: 0.5rem;
}

.footer-links a {
  color: #e2e8f0;
  text-decoration: none;
  transition: color 0.3s;
}

.footer-links a:hover {
  color: white;
  text-decoration: underline;
}

.map-container {
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  margin-top: 0.5rem;
}

.footer-copyright {
  text-align: center;
  margin-top: 2rem;
  padding-top: 1rem;
  border-top: 1px solid rgba(255,255,255,0.2);
  font-size: 0.9rem;
}

@media (max-width: 768px) {
  .footer-container {
    grid-template-columns: 1fr;
  }
  
  .map-container {
    height: 200px;
  }
}

  
  @media (max-width: 768px) {
    .footer-links {
      display: none;
    }
  }
  .visually-hidden {
  position: absolute;
  clip: rect(1px, 1px, 1px, 1px);
  width: 1px;
  height: 1px;
  overflow: hidden;
  white-space: nowrap;
}
   .match-container {
    margin-bottom: 1.5rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 1rem;
    background: white;
  }
  
  body.dark-mode .match-container {
    background: var(--dark-card);
    border-color: #4a5568;
  }
  
  .match-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }
  
  .match-players {
    font-weight: 600;
    font-size: 1.1rem;
  }
  
  .match-date {
    color: var(--gray-medium);
    font-size: 0.9rem;
  }
  
  .match-prediction {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px dashed #ddd;
  }
  
  body.dark-mode .match-prediction {
    border-top-color: #4a5568;
  }
  
  .prediction-title {
    font-weight: 600;
    margin-bottom: 0.5rem;
  }
  
  .prediction-options {
    display: flex;
    gap: 1rem;
    margin-bottom: 0.5rem;
    transition: opacity 0.3s ease;
}

.prediction-results-single {
    display: none;
    margin-top: 1rem;
    animation: fadeIn 0.6s ease-out;
}
  .prediction-btn {
    flex: 1;
    padding: 0.5rem;
    border: 1px solid var(--green);
    border-radius: 5px;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  body.dark-mode .prediction-btn {
    background: var(--dark-card);
    color: var(--dark-text);
  }
  
  .prediction-btn:hover {
    background: var(--green-light);
    color: white;
  }
  
  .prediction-btn.selected {
    background: var(--green);
    color: white;
  }
  
  .prediction-results {
    display: none;
    margin-top: 0.5rem;
  }
  
  .prediction-bar {
    height: 20px;
    background: var(--gray-light);
    border-radius: 10px;
    margin-bottom: 0.3rem;
    overflow: hidden;
  }
  
  body.dark-mode .prediction-bar {
    background: #4a5568;
  }
  
  .prediction-fill {
    height: 100%;
    background: var(--green);
    border-radius: 10px;
    width: 0%;
    transition: width 1s ease;
  }
  
  .prediction-percentage {
    font-size: 0.8rem;
    text-align: right;
  }
  
  .prediction-bar-single {
    height: 24px;
    background: var(--gray-light);
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    margin-bottom: 0.5rem;
  }
  
  body.dark-mode .prediction-bar-single {
    background: #4a5568;
  }
  
 .prediction-fill-left {
    height: 100%;
    background: var(--green); /* Verde per giocatore 1 */
    transition: width 1s ease;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding-left: 8px;
    color: white;
    font-weight: 600;
    font-size: 0.8rem;
    text-shadow: 0 0 2px rgba(0,0,0,0.5);
  }
  
  .prediction-fill-right {
    height: 100%;
    background: var(--blue); /* Azzurro (#4299e1) per giocatore 2 */
    transition: width 1s ease;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 8px;
    color: white;
    font-weight: 600;
    font-size: 0.8rem;
    text-shadow: 0 0 2px rgba(0,0,0,0.5);
  }
  
 .prediction-btn.green-btn {
  background-color: #4CAF50; /* verde */
  color: white;
}

.prediction-btn.blue-btn {
  background-color: #2196F3 !important; /* blu */
  color: white;
}
/* Aggiungi queste regole CSS */
  
  .prediction-bar-single {
    height: 24px;
    background: var(--gray-light);
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    margin-bottom: 0.5rem;
    position: relative;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
  }
  
  body.dark-mode .prediction-bar-single {
    background: #4a5568;
  }
  
  .prediction-fill-left {
    height: 100%;
    background: var(--green);
    transition: width 1.2s cubic-bezier(0.22, 0.61, 0.36, 1);
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding-left: 8px;
    color: white;
    font-weight: 600;
    font-size: 0.8rem;
    text-shadow: 0 0 2px rgba(0,0,0,0.5);
    position: relative;
    overflow: hidden;
    min-width: 30px; /* Per garantire che la percentuale sia sempre leggibile */
  }
  

  .prediction-fill-right {
    height: 100%;
    background: var(--blue);
    transition: width 1.2s cubic-bezier(0.22, 0.61, 0.36, 1);
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 8px;
    color: white;
    font-weight: 600;
    font-size: 0.8rem;
    text-shadow: 0 0 2px rgba(0,0,0,0.5);
    position: relative;
    overflow: hidden;
    min-width: 30px; /* Per garantire che la percentuale sia sempre leggibile */
  }
  
.prediction-fill-left::after,
.prediction-fill-right::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, 
      rgba(255,255,255,0.3) 0%, 
      rgba(255,255,255,0.1) 50%, 
      rgba(255,255,255,0.3) 100%);
    transform: translateX(-100%);
    transition: transform 0.7s ease-out;
}

.prediction-fill-left.active-shine::after,
.prediction-fill-right.active-shine::after {
    transform: translateX(100%);
}
  
  /* Animazione quando i risultati appaiono */
  .prediction-results-single {
    display: none;
    margin-top: 1rem;
    animation: fadeIn 0.6s ease-out;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  /* Aggiungi questo nello stile CSS */
.h2h-stat-card {
    background: var(--gray-light);
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
    margin-bottom: 1rem;
}

body.dark-mode .h2h-stat-card {
    background: #4a5568;
}

.h2h-stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--green);
    margin: 0.5rem 0;
}

.h2h-stat-label {
    font-size: 0.9rem;
    color: var(--gray-dark);
}

body.dark-mode .h2h-stat-label {
    color: var(--dark-text);
}

.h2h-match-history {
    margin-top: 1rem;
    max-height: 200px;
    overflow-y: auto;
}

.h2h-match-item {
    padding: 0.5rem;
    border-bottom: 1px solid #ddd;
    font-size: 0.9rem;
}

body.dark-mode .h2h-match-item {
    border-bottom-color: #4a5568;
}

.h2h-match-winner {
    font-weight: 600;
    color: var(--green);
}

.h2h-match-date {
    color: var(--gray-medium);
    font-size: 0.8rem;
}
/* Aggiungi questo alla fine dello stile CSS */
#headToHeadStats {
    margin-top: 1rem;
    transition: opacity 0.3s ease;
}

#opponentSelect {
    width: 100%;
    padding: 0.5rem;
    margin-bottom: 1rem;
    border-radius: 5px;
    border: 1px solid var(--gray-medium);
    font-family: 'Poppins', sans-serif;
}

body.dark-mode #opponentSelect {
    background: #4a5568;
    color: var(--dark-text);
    border-color: #718096;
}

.h2h-stat-card {
    background: var(--gray-light);
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
    margin-bottom: 1rem;
}

body.dark-mode .h2h-stat-card {
    background: #4a5568;
}

.h2h-stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--green);
    margin: 0.5rem 0;
}

.h2h-stat-label {
    font-size: 0.9rem;
    color: var(--gray-dark);
}

body.dark-mode .h2h-stat-label {
    color: var(--dark-text);
}

.h2h-match-history {
    margin-top: 1rem;
    max-height: 200px;
    overflow-y: auto;
}

.h2h-match-item {
    padding: 0.5rem;
    border-bottom: 1px solid #ddd;
    font-size: 0.9rem;
}

body.dark-mode .h2h-match-item {
    border-bottom-color: #4a5568;
}

.h2h-match-winner {
    font-weight: 600;
    color: var(--green);
}

.h2h-match-date {
    color: var(--gray-medium);
    font-size: 0.8rem;
}
/* Aggiungi queste regole */
.prediction-fill-left, .prediction-fill-right {
    transition: width 0.7s cubic-bezier(0.22, 0.61, 0.36, 1);
}

.active-shine::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, 
        rgba(255,255,255,0.3) 0%, 
        rgba(255,255,255,0.1) 50%, 
        rgba(255,255,255,0.3) 100%);
    animation: shine 0.7s ease-out;
}

@keyframes shine {
    from { transform: translateX(-100%); }
    to { transform: translateX(100%); }
}
</style>
</head>
<body>
<header>
<h1 class="visually-hidden">Tennis Cup - Circuito Amatoriale di Tornei 2025</h1>
  <div class="header-controls">
    <button class="header-btn" id="simulatorBtn">Simulatore</button>
    <button class="header-btn" id="darkModeBtn">Modalità Scura</button>
  </div>
  <div class="header-title-container">
    TENNIS CUP <span id="header-year">2025</span>
    <div class="tennis-ball-container">
      <div class="tennis-ball"></div>
    </div>
  </div>
  <span class="edition-select-container" aria-label="Seleziona edizione">
    <select id="editionSelect" aria-live="polite">
      <option value="2025" selected>2025</option>
      <option value="2026">2026</option>
      <option value="2027">2027</option>
    </select>
  </span>
</header>

<main>

<section id="classifica" aria-label="Classifica giocatori">
  <h2>Classifica</h2>
  <div id="classifica-bars" role="list" aria-live="polite" aria-relevant="additions"></div>
</section>

<section id="calendario" aria-label="Calendario Slam">
  <h2>Calendario Slam</h2>
  <div class="grid" role="list" id="tournamentGrid"></div>
</section>

<section id="news" aria-label="Notizie recenti">
  <h2>Ultime Notizie</h2>
  <div class="news-container" id="newsContainer"></div>
  <div class="news-controls">
    <button class="show-all-btn" id="showAllNewsBtn" aria-label="Visualizza tutte le notizie">Visualizza tutte</button>
    <button class="reduce-btn" id="reduceNewsBtn" aria-label="Riduci visualizzazione" style="display:none;">Riduci</button>
  </div>
</section>

<section id="galleria" aria-label="Galleria immagini">
  <h2>Galleria</h2>
  <div class="thumbs" id="galleryThumbs"></div>
  <div class="gallery-controls">
    <button class="show-all-btn" id="showAllBtn" aria-label="Visualizza tutte le immagini">Visualizza tutte</button>
    <button class="reduce-btn" id="reduceBtn" aria-label="Riduci visualizzazione" style="display:none;">Riduci</button>
  </div>
</section>

<section id="faq" aria-label="Domande frequenti">
  <h2>Domande Frequenti</h2>
  <div class="faq-container">
    <!-- Domanda 1 -->
    <div class="faq-item">
      <button class="faq-question click-feedback">
        Come posso partecipare ai tornei?
        <span class="faq-icon">+</span>
      </button>
      <div class="faq-answer">
        <p>La Tennis Cup è attualmente un circuito riservato ai 5 giocatori fissi. Tuttavia, non escludiamo la possibilità di arrivi futuri, resta aggiornato seguendo le notizie del sito!</p>
      </div>
    </div>
    
    <!-- Domanda 2 -->
    <div class="faq-item">
  <button class="faq-question click-feedback">
    Dove e quando si svolgono i tornei?
    <span class="faq-icon">+</span>
  </button>
  <div class="faq-answer">
    <p>I tornei si svolgono presso il <a href="#footer-map" style="color: var(--green);">Circolo Tennis di Porto</a>, generalmente a metà settimana. Il calendario completo è disponibile nella sezione <a href="#calendario" style="color: var(--green);">Calendario Slam</a> di questo sito.</p>
  </div>
</div>
    
    <!-- Domanda 3 -->
    <div class="faq-item">
      <button class="faq-question click-feedback">
        Come funziona il sistema di punteggio?
        <span class="faq-icon">+</span>
      </button>
      <div class="faq-answer">
        <p>Il punteggio si basa principalmente sulla posizione finale nel torneo. Puoi simulare l'effetto sui punteggi usando il nostro<a href="#" onclick="document.getElementById('simulatorBtn').click(); return false;" style="color: var(--green);">   Simulatore di Classifica!</a></p>
      </div>
    </div>

    <!-- Aggiungi questa domanda nella sezione FAQ, dopo le domande esistenti -->
<div class="faq-item">
  <button class="faq-question click-feedback">
    Come funzionano i pronostici?
    <span class="faq-icon">+</span>
  </button>
  <div class="faq-answer">
    <p>I pronostici calcolano la probabilità di vittoria basandosi su:</p>
    
    <div style="margin-left:20px;">
      • <strong>Classifica</strong> (65% peso)<br>
      • <strong>Scontri diretti</strong> (25%)<br>
      • <strong>Ultimi 3 match</strong> (7%)<br>
      • <strong>Attività recente</strong> (3%)
    </div>

    <p>Le probabilità restano sempre tra 15% e 85%. Provali nella sezione dettagli tornei!</p>
  </div>
</div>
  </div>
</section>

</main>

<!-- Popup torneo -->
<div id="popup" role="dialog" aria-modal="true" aria-labelledby="popup-title" aria-hidden="true">
  <button id="popup-close" aria-label="Chiudi popup">&times;</button>
  <h3 id="popup-title"></h3>
  <div id="popup-content"></div>
  <button id="detailsBtn" style="display:none;">Dettagli torneo</button>
  <!-- Aggiungi questo nuovo pulsante -->
  <button id="standingsBtn" style="display:none;">Classifica torneo</button>
  <div id="popup-details" style="display:none;"></div>
</div>

<!-- Lightbox immagine -->
<div id="lightbox" role="dialog" aria-modal="true" aria-label="Immagine ingrandita">
  <button id="lightbox-close" aria-label="Chiudi immagine">&times;</button>
  <img src="" alt="" />
</div>

<!-- Player Stats Page (hidden by default) -->
<div id="playerStatsPage" style="display:none;">
  <main>
    <a href="#" class="back-btn" id="backBtn">← Torna alla classifica</a>
    <div class="player-stats-container">
      <div class="player-header">
        <img src="" alt="Player Avatar" class="player-avatar" id="playerAvatar">
        <h1 class="player-name" id="playerName"></h1>
      </div>
      
      <div class="stats-section">
        <h3>Statistiche Generali</h3>
        <div class="filter-controls">
          <button class="filter-btn active" data-filter="all">Tutti i match</button>
          <button class="filter-btn" data-filter="slam">Solo Grandi Slam</button>
          <button class="filter-btn" data-filter="friendly">Solo Amichevoli</button>
	   </div>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Tornei vinti</div>
            <div class="stat-value" id="torneiVinti">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Match giocati</div>
            <div class="stat-value" id="matchGiocati">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Match vinti</div>
            <div class="stat-value" id="matchVinti">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">% Vittorie</div>
            <div class="stat-value" id="percentualeVittorie">0%</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Set vinti</div>
            <div class="stat-value" id="setVinti">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Set persi</div>
            <div class="stat-value" id="setPersi">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Game vinti</div>
            <div class="stat-value" id="gameVinti">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Game persi</div>
            <div class="stat-value" id="gamePersi">0</div>
          </div>
        </div>
      </div>
       <!-- Aggiungi questo nella sezione stats-section, prima del stats-grid -->
		<div class="stats-section">
			<h3>Scontri Diretti</h3>
			<div class="filter-controls">
				<button class="filter-btn active" data-h2h-filter="all">Tutti i match</button>
				<button class="filter-btn" data-h2h-filter="slam">Solo Grandi Slam</button>
				<button class="filter-btn" data-h2h-filter="friendly">Solo Amichevoli</button>
			</div>
			<div class="form-group">
				<label for="opponentSelect" class="form-label">Confronta con:</label>
				<select id="opponentSelect" class="simulator-select">
					<!-- Le opzioni verranno popolate dinamicamente -->
				</select>
			</div>
			<div id="headToHeadStats" class="stats-grid" style="display: none;">
				<!-- Qui verranno mostrate le statistiche -->
			</div>
		</div>
      <div class="stats-section">
        <h3>Tornei vinti</h3>
        <div class="trophies-container" id="trophiesContainer"></div>
      </div>
    </div>
  </main>
</div>

<!-- Simulator Page (hidden by default) -->
<div id="simulatorPage" style="display:none;">
  <main>
    <a href="#" class="back-btn" id="simulatorBackBtn">← Torna alla classifica</a>
    <div class="simulator-container">
      <h2>Simulatore Classifica</h2>
      <p>Simula cosa succederebbe alla classifica se un giocatore vincesse il prossimo torneo.</p>
      
      <div class="form-group">
        <label for="simulateTournament" class="form-label">Seleziona torneo:</label>
        <select id="simulateTournament" class="simulator-select">
          <option value="heatCup">HEAT CUP (Giugno - Agosto)</option>
          <option value="orangeTournament">ORANGE TOURNAMENT (Settembre - Novembre)</option>
          <option value="snowSlam">SNOW SLAM (Dicembre - Febbraio)</option>
        </select>
      </div>
      
      <div class="form-group">
  <label class="form-label">Posizioni finali:</label>
  <div class="position-inputs">
    <div class="position-input">
      <label for="pos1">1°:</label>
      <select id="pos1" class="simulator-select position-select">
        <option value="Gioxter">Gioxter</option>
        <option value="Enrico">Enrico</option>
        <option value="Usud">Usud</option>
        <option value="Paolo">Paolo</option>
        <option value="Michele">Michele</option>
      </select>
    </div>
    <div class="position-input">
      <label for="pos2">2°:</label>
      <select id="pos2" class="simulator-select position-select">
        <option value="Gioxter">Gioxter</option>
        <option value="Enrico">Enrico</option>
        <option value="Usud">Usud</option>
        <option value="Paolo">Paolo</option>
        <option value="Michele">Michele</option>
      </select>
    </div>
    <div class="position-input">
      <label for="pos3">3°:</label>
      <select id="pos3" class="simulator-select position-select">
        <option value="Gioxter">Gioxter</option>
        <option value="Enrico">Enrico</option>
        <option value="Usud">Usud</option>
        <option value="Paolo">Paolo</option>
        <option value="Michele">Michele</option>
      </select>
    </div>
    <div class="position-input">
      <label for="pos4">4°:</label>
      <select id="pos4" class="simulator-select position-select">
        <option value="Gioxter">Gioxter</option>
        <option value="Enrico">Enrico</option>
        <option value="Usud">Usud</option>
        <option value="Paolo">Paolo</option>
        <option value="Michele">Michele</option>
      </select>
    </div>
    <div class="position-input">
      <label for="pos5">5°:</label>
      <select id="pos5" class="simulator-select position-select">
        <option value="Gioxter">Gioxter</option>
        <option value="Enrico">Enrico</option>
        <option value="Usud">Usud</option>
        <option value="Paolo">Paolo</option>
        <option value="Michele">Michele</option>
      </select>
    </div>
  </div>
</div>
      
      <button id="simulateBtn" class="simulate-btn">Simula</button>
      
      <div id="simulationResult" class="simulation-result"></div>
    </div>
  </main>
</div>
<!-- Avatar Lightbox -->
<div id="avatar-lightbox" role="dialog" aria-modal="true" aria-label="Avatar ingrandito">
    <button id="avatar-lightbox-close" aria-label="Chiudi avatar">&times;</button>
    <img src="" alt="" />
</div>
<footer id="footer-map">
  <div class="footer-container">
    <div class="about">
  <h3>Tennis Cup</h3>
  <p>Circuito amatoriale di tornei tra amici dal 2025. Classifiche ufficiali, calendari e risultati dei tornei THE SINNER, HEAT CUP, ORANGE TOURNAMENT e SNOW SLAM.</p>
</div>
    <div class="footer-links">
      <h3>Link Utili</h3>
      <ul>
        <li><a href="#classifica">Classifica</a></li>
        <li><a href="#calendario">Calendario</a></li>
        <li><a href="#news">Notizie</a></li>
      </ul>
    </div>
    <div class="footer-map">
      <h3>Dove giochiamo</h3>
      <div class="map-container">
        <iframe 
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2830.097757800344!2d11.3181573!3d45.2015848!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x477f13f0e638cbf1%3A0xf1ccee41508be487!2sCampi%20da%20Tennis!5e0!3m2!1sit!2sit!4v1722867429045!5m2!1sit!2sit" 
          width="100%" 
          height="200" 
          style="border:0;" 
          allowfullscreen="" 
          loading="lazy"
          aria-label="Mappa del Circolo Tennis di Porto Tolle">
        </iframe>
      </div>
    </div>
    
  </div>
  
  <div class="footer-copyright">
    <p>&copy; 2025 Tennis Cup Org. Tutti i diritti riservati.</p>
  </div>
</footer>


<script>
  // ********** DATI GLOBALI **********

  // ********** SUONO CLICK **********
  
function playFeedback(event) {
    // Vibrazione su mobile
    if ('vibrate' in navigator) {
      try {
        navigator.vibrate(10); // 10ms di vibrazione brevissima
      } catch (e) {
        console.log("Vibration error:", e);
      }
    }
    
    // Effetto visivo su desktop
    const el = event.currentTarget;
    el.classList.add('click-feedback');
    setTimeout(() => {
      el.classList.remove('click-feedback');
    }, 300);
  }

  // Aggiungi feedback a tutti gli elementi interattivi
  document.addEventListener('DOMContentLoaded', () => {
    const interactiveElements = [
      'button', '.tournament-card', 
      '#classifica-bars div[role="listitem"]', 
      '#galleryThumbs img', '.video-thumb',
      'a', '.form-input', '.form-textarea',
      '.header-btn', '.back-btn', '.show-all-btn',
      '.reduce-btn', '.submit-btn', '.simulate-btn'
    ];
    
    interactiveElements.forEach(selector => {
      document.querySelectorAll(selector).forEach(el => {
        // Click/touch
        el.addEventListener('click', playFeedback);
        
        // Tastiera (per accessibilità)
        el.addEventListener('keypress', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            playFeedback(e);
          }
        });
      });
    });
  });

  // Dati base giocatori, punteggi per edizione e ultimo slam
  const players = ['Gioxter', 'Enrico', 'Usud', 'Paolo', 'Michele'];
  
  // Dati avatar giocatori (puoi cambiare i link)
  const playerAvatars = {
    'Gioxter': 'img/avatars/gioxter.jpg',
    'Enrico': 'img/avatars/enrico.jpg',
    'Usud': 'img/avatars/usud.jpg',
    'Paolo': 'img/avatars/paolo.jpg',
    'Michele': 'img/avatars/michele.jpg'
  };
  
    // Dati notizie (esempio con più notizie)
  const newsData = [
  {
        title: "HEAT CUP SEMIFINALE: Enrico batte Gioxter 2-6, 6-2, 6-2",
        date: "8 settembre 2025",
        content: 'Prima semifinale della Heat Cup tra Gioxter e Enrico. Enrico vince una partita importantissima e Gioxter dichiara che si rifarà. La rivalità tra i due si è ufficialmente riaccesa con questa vittoria! ',
      },
  {
        title: "HEAT CUP secondo QUARTO DI FINALE: Usud batte Paolo a tavolino!",
        date: "6 settembre 2025",
        content: 'Con grande dispiacere Paolo abbandona il torneo e decide di dare ad Usud la possibilità di scontrarsi per la vittoria finale con un grande gesto di cuore. La partita era sul 6-4, 3-6, 3-1 prima del ritiro. Usud dichiara: Nessuno voleva che finisse così e a malincuore io giocherò anche per Paolo.',
      },
  {
        title: "HEAT CUP secondo OTTAVO DI FINALE: Usud batte Michele 6-2,6-2",
        date: "4 settembre 2025",
        content: 'Usud vince il quarto di finale ed elimina Michele! Michele dichiara: Partita dopo partita sto  migliorando, non sono ancora pronto per competere per questo torneo, ma di questo passo posso competere per un quarto posto allo snow slam. Faccio i complimenti al mio avversario che anche se non ha giocato come può é stato superiore, nel heat cup 2026 ci sarà scritto il mio nome!',
      },
  {
        title: "Amichevole: Enrico batte Gioxter 5-7, 6-2, 7(11)-6(9)",
        date: "3 settembre 2025",
        content: 'Enrico si prende la sua rivincita contro Gioxter che aveva vinto i due precedenti incontri! Gioco fuocoso da parte di Gioxter che arriva su tutte le palle, ma Enrico lo fa stancare e vince.',
      },
  {
        title: "Amichevole: Usud battuto da Gioxter 1-6, 5-7",
        date: "30 Agosto 2025",
        content: 'Usud perde una amichevole, ma afferma che la vittoria della HEAT CUP sarà sua! Gioxter allunga la sua striscia di vittorie consecutive.'
      },
    {
        title: "HEAT CUP primo QUARTO DI FINALE: Paolo vs Enrico",
        date: "27 Agosto 2025",
        content: 'Paolo perde contro Enrico ai quarti per 3-6, 3-6 senza dichiarazioni! Paolo avrà comunque una seconda possibilità contro il vincente nella sfida Usud vs Michele!'
      },
      {
        title: "HEAT CUP primo OTTAVO DI FINALE: Paolo vs Usud",
        date: "26 Agosto 2025",
        content: 'Paolo vince contro Usud la prima sfida della fase a tabellone per 7(7)-6(5), 6-3. Dopo questa sfida Usud dichiara che il fisico non ha retto e ha fatto errori imperdonabili. Paolo invece si dichiara pronto ad affrontare Enrico!'
      },
     {
      title: "HEAT CUP: Risultati fase a gironi disponibili",
      date: "10 Agosto 2025",
      content: 'Gironi conclusi con Gioxter dominatore (4-0). Risultati nei dettagli torneo!'
    },
    {
      title: "Amichevole: Usud batte Michele 6-1, 6-2",
      date: "6 Agosto 2025",
      content: "Partita pessima tra i due giocatori. Usud ha la meglio perché l'avversario non ha le mani."
    },
	{
      title: "Partita alla play: Usud batte Gioxter 2 set a 1 a TopSpin",
      date: "3 Agosto 2025",
      content: "Match combattuto, ma alla fine Usud ha la meglio su Gioxter. Questa sconfitta lascerà qualche segno sull’ego di Gioxter in vista delle prossime sfide?"
    },
    {
      title: "Amichevole: Enrico batte Usud 6-4, 6(1)-6(7), 6(10)-6(7)",
      date: "31 Luglio 2025",
      content: "Amichevole estiva combattuta fino all’ultimo punto: Usud dà tutto, ma Enrico si impone con una prestazione maestosa."
    },
	{
      title: "Amichevole: Paolo batte Usud 6-4",
      date: "29 Luglio 2025",
      content: "Paolo vince contro Usud e dimostra ad Usud tutta la sua potenza."
    },
	{
      title: "Amichevole: Paolo batte Michele 6-3",
      date: "29 Luglio 2025",
      content: "Paolo vince contro Michele in un match vivace."
    },
    {
      title: "Amichevole: Usud batte Michele 6-4",
      date: "29 Luglio 2025",
      content: "Usud vince contro Michele in un match molto interessante."
    },
    {
      title: "Preparazione HEAT CUP",
      date: "10 Luglio 2025",
      content: "I giocatori si allenano per il prossimo torneo estivo."
    },
	{
      title: "THE SINNER: Gioxter vince il torneo inaugurale",
      date: "4 Giugno 2025",
      content: "Gioxter si è aggiudicato il primo torneo della TENNIS CUP 2025."
    },
	{
      title: "Presentazione TENNIS CUP 2025",
      date: "1 Marzo 2025",
      content: "È ufficialmente iniziata la TENNIS CUP 2025!"
    }
  ];

  let newsShowingAll = false;
  const newsContainer = document.getElementById('newsContainer');
  const showAllNewsBtn = document.getElementById('showAllNewsBtn');

  function renderNews() {
    newsContainer.innerHTML = '';
    let newsToShow = newsShowingAll ? newsData : newsData.slice(0, 3);
    
    newsToShow.forEach(news => {
      const card = document.createElement('div');
      card.className = 'news-card';
      
      const title = document.createElement('h3');
      title.className = 'news-title';
      title.textContent = news.title;
      
      const date = document.createElement('div');
      date.className = 'news-date';
      date.textContent = news.date;
      
      const content = document.createElement('p');
      content.textContent = news.content;
      
      card.appendChild(title);
      card.appendChild(date);
      card.appendChild(content);
      
      newsContainer.appendChild(card);
    });
    
    // Mostra il pulsante solo se ci sono più di 3 notizie
    if (!newsShowingAll && newsData.length > 3) {
      showAllNewsBtn.style.display = 'block';
    } else {
      showAllNewsBtn.style.display = 'none';
    }
  }

  showAllNewsBtn.addEventListener('click', () => {
    newsShowingAll = true;
    renderNews();
  });

  // Inizializza la visualizzazione
  renderNews();
  // Dati amichevoli (da aggiungere ai dati tornei)
  const friendlyMatches = [
  {
      date: "03/09/2025",
      player1: "Enrico",
      player2: "Gioxter",
      winner: "Enrico",
      score: "5-7, 6-2, 7-6",
      sets: [
        { player1: 2, player2: 1 }
      ],
	  totalGames: {
      player1: 5+6+7,
      player2: 7+2+6
	  }
    },
  {
      date: "30/08/2025",
      player1: "Usud",
      player2: "Gioxter",
      winner: "Gioxter",
      score: "1-6, 5-7",
      sets: [
        { player1: 0, player2: 2 }
      ],
	  totalGames: {
      player1: 1+5,
      player2: 6+7
	  }
    },
	{
      date: "06/08/2025",
      player1: "Usud",
      player2: "Michele",
      winner: "Usud",
      score: "6-1, 6-2",
      sets: [
        { player1: 2, player2: 0 }
      ],
	  totalGames: {
      player1: 6+6,
      player2: 1+2
	  }
    },
    {
      date: "31/07/2025",
      player1: "Enrico",
      player2: "Usud",
      winner: "Enrico",
      score: "6-4, 6-7, 7-6",
      sets: [
        { player1: 2, player2: 1 }
      ],
	  totalGames: {
      player1: 6+6+7, // 19
      player2: 4+7+6  // 17
	  }
    },
	{
      date: "29/07/2025",
      player1: "Usud",
      player2: "Michele",
      winner: "Usud",
      score: "6-4",
      sets: [
        { player1: 1, player2: 0 }
      ],
    totalGames: {
      player1: 6,
      player2: 4
      }
    },
	{
      date: "29/07/2025",
      player1: "Paolo",
      player2: "Michele",
      winner: "Paolo",
      score: "6-3",
      sets: [
        { player1: 1, player2: 0 }
      ],
	  totalGames: {
      player1: 6,
      player2: 3
     }
    },
    {
      date: "29/07/2025",
      player1: "Usud",
      player2: "Paolo",
      winner: "Paolo",
      score: "4-6",
      sets: [
        { player1: 0, player2: 1 }
      ],
	  totalGames: {
      player1: 4,
      player2: 6
      }
    }
  ];

  const editionsData = {
  '2025': {
    classifica: {
      'Gioxter': 1000,
      'Enrico': 600,
      'Usud': 400,
      'Paolo': 250,
      'Michele': 150
    },
    lastSlamPoints: {
      'Gioxter': 1000,
      'Enrico': 600,
      'Usud': 400,
      'Paolo': 250,
      'Michele': 150
    },
    tournaments: [
      {
        id: 'theSinner',
        name: 'THE SINNER',
        season: 'Primavera 🌸',
        date: 'Marzo - Maggio',
        played: true,
        winner: 'Gioxter',
        description: 'Il torneo inaugurale della TENNIS CUP 2025, THE SINNER, è un inizio fresco e carico di energia. Giocato tra marzo e maggio, porta un’atmosfera frizzante e primaverile: campi luminosi, fiori che sbocciano e rivalità già decise. Gioxter si è affermato come primo campione, dominando con grinta e stile. Perfetto per dare il via al circuito con eleganza e tensione.',
        phaseGironi: [
          { 
            group: 'Fase a gironi', 
            matches: [
              {
                date: "15/03/2025",
                player1: 'Enrico',
                player2: 'Gioxter',
                winner: 'Enrico',
                score: '4-2',
                sets: [{ player1: 1, player2: 0 }],
                totalGames: { player1: 4, player2: 2 }
              },
              {
                date: "15/03/2025",
                player1: 'Michele',
                player2: 'Usud',
                winner: 'Usud',
                score: '0-4',
                sets: [{ player1: 0, player2: 1 }],
                totalGames: { player1: 0, player2: 4 }
              },
              {
                date: "22/03/2025",
                player1: 'Michele',
                player2: 'Gioxter',
                winner: 'Gioxter',
                score: '1-4',
                sets: [{ player1: 0, player2: 1 }],
                totalGames: { player1: 1, player2: 4 }
              },
              {
                date: "22/03/2025",
                player1: 'Paolo',
                player2: 'Gioxter',
                winner: 'Gioxter',
                score: '1-4',
                sets: [{ player1: 0, player2: 1 }],
                totalGames: { player1: 1, player2: 4 }
              },
              {
                date: "29/03/2025",
                player1: 'Paolo',
                player2: 'Michele',
                winner: 'Paolo',
                score: '4-2',
                sets: [{ player1: 1, player2: 0 }],
                totalGames: { player1: 4, player2: 2 }
              },
              {
                date: "29/03/2025",
                player1: 'Usud',
                player2: 'Gioxter',
                winner: 'Gioxter',
                score: '0-4',
                sets: [{ player1: 0, player2: 1 }],
                totalGames: { player1: 0, player2: 4 }
              },
              {
                date: "05/04/2025",
                player1: 'Paolo',
                player2: 'Enrico',
                winner: 'Enrico',
                score: '3-4',
                sets: [{ player1: 0, player2: 1 }],
                totalGames: { player1: 3, player2: 4 }
              },
              {
                date: "05/04/2025",
                player1: 'Paolo',
                player2: 'Usud',
                winner: 'Usud',
                score: '1-4',
                sets: [{ player1: 0, player2: 1 }],
                totalGames: { player1: 1, player2: 4 }
              },
              {
                date: "12/04/2025",
                player1: 'Enrico',
                player2: 'Michele',
                winner: 'Enrico',
                score: '4-0',
                sets: [{ player1: 1, player2: 0 }],
                totalGames: { player1: 4, player2: 0 }
              },
              {
                date: "12/04/2025",
                player1: 'Usud',
                player2: 'Enrico',
                winner: 'Enrico',
                score: '2-4',
                sets: [{ player1: 0, player2: 1 }],
                totalGames: { player1: 2, player2: 4 }
              }
            ]
          }
        ],
        phaseTabellone: [
          { 
            round: 'Ottavi', 
            matches: [
              {
                date: "19/04/2025",
                player1: 'Usud',
                player2: 'Paolo',
                winner: 'Paolo',
                score: '3-4, 0-4',
                sets: [
                  { player1: 0, player2: 2 }
                ],
                totalGames: { player1: 3+0, player2: 4+4 }
              },
              {
                date: "19/04/2025",
                player1: 'Usud',
                player2: 'Michele',
                winner: 'Usud',
                score: '4-2, 4-0',
                sets: [
                  { player1: 2, player2: 0 }
                ],
                totalGames: { player1: 4+4, player2: 2+0 }
              }
            ]
          },
          { 
            round: 'Quarti', 
            matches: [
              {
                date: "26/04/2025",
                player1: 'Gioxter',
                player2: 'Paolo',
                winner: 'Gioxter',
                score: '4-2, 4-3',
                sets: [
                  { player1: 2, player2: 0 }
                ],
                totalGames: { player1: 4+4, player2: 2+3 }
              },
              {
                date: "26/04/2025",
                player1: 'Paolo',
                player2: 'Usud',
                winner: 'Usud',
                score: '3-5, 4-1, 3-5',
                sets: [
                  { player1: 1, player2: 2 }
                ],
                totalGames: { player1: 3+4+3, player2: 5+1+5 }
              }
            ]
          },
          { 
            round: 'Semifinali', 
            matches: [
              {
                date: "03/05/2025",
                player1: 'Enrico',
                player2: 'Gioxter',
                winner: 'Enrico',
                score: '2-4, 4-2, 4-2',
                sets: [
				{ player1: 2, player2: 1 }
                ],
                totalGames: { player1: 2+4+4, player2: 4+2+2 }
              },
              {
                date: "03/05/2025",
                player1: 'Gioxter',
                player2: 'Usud',
                winner: 'Gioxter',
                score: '4-1, 4-0',
                sets: [
                  { player1: 2, player2: 0 }
                ],
                totalGames: { player1: 4+4, player2: 1+0 }
              }
            ]
          },
          { 
            round: 'Finale', 
            matches: [
              {
                date: "10/05/2025",
                player1: 'Enrico',
                player2: 'Gioxter',
                winner: 'Gioxter',
                score: '2-4, 4-2, 2-4',
                sets: [
                  { player1: 1, player2: 2 }
                ],
                totalGames: { player1: 2+4+2, player2: 4+2+4 }
              }
            ]
          }
         ]   
        },
        {
          id: 'heatCup',
          name: 'HEAT CUP',
          season: 'Estate 🔥',
          date: 'Giugno - Agosto',
          played: false,
          winner: null,
          description: 'In programma tra giugno e agosto, HEAT CUP è il torneo più rovente dell’anno. Immagina un campo avvolto dal calore estivo, palline infuocate e uno spirito competitivo al massimo. È il momento in cui la TENNIS CUP diventa esplosiva: grandi scambi, adrenaline e match all’ultimo punto. Un evento visivamente potente, come merita il nome "Heat".',
           phaseGironi: [ 
    { 
      group: 'Fase a gironi', 
      matches: [
        {
          date: "10/08/2025",
          player1: 'Enrico',
          player2: 'Gioxter',
          winner: 'Gioxter',
          score: '1-4',
          sets: [{ player1: 0, player2: 1 }],
          totalGames: { player1: 1, player2: 4 }
        },
        {
          date: "10/08/2025",
          player1: 'Usud',
          player2: 'Michele',
          winner: 'Usud',
          score: '4-3',
          sets: [{ player1: 1, player2: 0 }],
          totalGames: { player1: 4, player2: 3 }
        },
        {
          date: "10/08/2025",
          player1: 'Paolo',
          player2: 'Enrico',
          winner: 'Enrico',
          score: '3-4',
          sets: [{ player1: 0, player2: 1 }],
          totalGames: { player1: 3, player2: 4 }
        },
        {
          date: "10/08/2025",
          player1: 'Michele',
          player2: 'Gioxter',
          winner: 'Gioxter',
          score: '4-0',
          sets: [{ player1: 0, player2: 1 }],
          totalGames: { player1: 0, player2: 4 }
        },
        {
          date: "10/08/2025",
          player1: 'Paolo',
          player2: 'Usud',
          winner: 'Usud',
          score: '1-4',
          sets: [{ player1: 0, player2: 1 }],
          totalGames: { player1: 1, player2: 4 }
        },
        {
          date: "10/08/2025",
          player1: 'Paolo',
          player2: 'Michele',
          winner: 'Paolo',
          score: '4-2',
          sets: [{ player1: 1, player2: 0 }],
          totalGames: { player1: 4, player2: 2 }
        },
        {
          date: "10/08/2025",
          player1: 'Usud',
          player2: 'Enrico',
          winner: 'Enrico',
          score: '1-4',
          sets: [{ player1: 0, player2: 1 }],
          totalGames: { player1: 1, player2: 4 }
        },
        {
          date: "10/08/2025",
          player1: 'Gioxter',
          player2: 'Paolo',
          winner: 'Gioxter',
          score: '4-0',
          sets: [{ player1: 1, player2: 0 }],
          totalGames: { player1: 4, player2: 0 }
        },
        {
          date: "10/08/2025",
          player1: 'Usud',
          player2: 'Gioxter',
          winner: 'Gioxter',
          score: '2-4',
          sets: [{ player1: 0, player2: 1 }],
          totalGames: { player1: 2, player2: 4 }
        },
        {
          date: "10/08/2025",
          player1: 'Michele',
          player2: 'Enrico',
          winner: 'Enrico',
          score: '2-4',
          sets: [{ player1: 0, player2: 1 }],
          totalGames: { player1: 2, player2: 4 }
			}
		  ]
		}
	  ],
         
		 phaseTabellone: [
		    {
                round: 'Ottavi',
                matches: [
                  {
                    date: "26/08/2025", // Sostituisci con la data corretta
                    player1: 'Usud',
                    player2: 'Paolo',
                    winner: 'Paolo', // Vincitore non ancora deciso
                    score: '7(7)-6(5), 6-3', // Punteggio vuoto
                    sets: [
                      { player1: 0, player2: 2 } // Set non ancora giocati
                    ],
                    totalGames: { player1: 6 + 3, player2: 7 + 6 } // Totale giochi vuoto
                  },
                  {
                    date: "04/09/2025", // Sostituisci con la data corretta
                    player1: 'Usud',
                    player2: 'Michele',
                    winner: 'Usud', // Vincitore non ancora deciso
                    score: '6-2,6-2', // Punteggio vuoto
                    sets: [
                      { player1: 2, player2: 0 } // Set non ancora giocati
                    ],
                    totalGames: { player1: 6 + 6, player2: 2 + 2 } // Totale giochi vuoto
                  }
                ]
              },
              {
                round: 'Quarti',
                matches: [
                  {
                    date: "27/08/2025",
                    player1: 'Paolo',
                    player2: 'Enrico',
                    winner: 'Enrico',
                    score: '3-6, 3-6',
                    sets: [
                      { player1: 0, player2: 2 }
                    ],
                    totalGames: { player1: 3 + 3, player2: 6 + 6 }
                  },
				  {
                    date: "06/09/2025",
                    player1: 'Usud',
                    player2: 'Paolo',
                    winner: 'Usud',
                    score: '6-4, 3-6, 3-1(rit)',
                    sets: [
                      { player1: 2, player2: 1 }
                    ],
                    totalGames: { player1: 6 + 3 + 3, player2: 4 + 6 + 1}
                  }
                ]
              },
              {
                round: 'Semifinali',
                matches: [
				  {
                    date: "08/09/2025",
                    player1: 'Enrico',
                    player2: 'Gioxter',
                    winner: 'Enrico',
                    score: '2-6, 6-2, 6-2',
                    sets: [
                      { player1: 2, player2: 1 }
                    ],
                    totalGames: { player1: 2 + 6 + 6, player2: 6 + 2 + 2}
                  },
                  {
                    date: "09/09/2025",
                    player1: 'Usud',
                    player2: 'Gioxter',
                    winner: null,
                    score: '',
                    sets: [
                      { player1: null, player2: null } // Set non ancora giocati
                    ],
                    totalGames: { player1: null, player2: null } // Totale giochi vuoto
                  }
                ]
              }
            ]
          },
        {
          id: 'orangeTournament',
          name: 'ORANGE TOURNAMENT',
          season: 'Autunno 🍂',
          date: 'Settembre - Novembre',
          played: false,
          winner: null,
          description: 'Tra settembre e novembre, ORANGE TOURNAMENT è un trionfo di colori autunnali: foglie arancioni che cadono, luce dorata e un’atmosfera calda e avvolgente. Ideale per un torneo elegante ma minaccioso, dove la classifica si fa sempre più incerta e ogni punto conta davvero. Qui si gioca con cervello e resistenza.',
          phaseGironi: [],
          phaseTabellone: []
        },
        {
          id: 'snowSlam',
          name: 'SNOW SLAM',
          season: 'Inverno ❄️',
          date: 'Dicembre - Febbraio',
          played: false,
          winner: null,
          description: 'Da dicembre a febbraio, SNOW SLAM è l’ultimo capitolo dell’anno: neve, gelido silenzio e atmosfera da montagna. Il campo è un contrasto tra gelo e calore umano: racchettate spettacolari, smash sul ghiaccio e un pupazzo di neve "cattivo" in stile cartoon. È il torneo perfetto per chiudere la TENNIS CUP 2025 con stile e brivido.',
          phaseGironi: [],
          phaseTabellone: []
        }
      ]
    },
    '2026': {
      classifica: {
        'Gioxter': 0,
        'Enrico': 0,
        'Usud': 0,
        'Paolo': 0,
        'Michele': 0
      },
      lastSlamPoints: {
        'Gioxter': 0,
        'Enrico': 0,
        'Usud': 0,
        'Paolo': 0,
        'Michele': 0
      },
      tournaments: []
    },
    '2027': {
      classifica: {
        'Gioxter': 0,
        'Enrico': 0,
        'Usud': 0,
        'Paolo': 0,
        'Michele': 0
      },
      lastSlamPoints: {
        'Gioxter': 0,
        'Enrico': 0,
        'Usud': 0,
        'Paolo': 0,
        'Michele': 0
      },
      tournaments: []
    }
  };

  // ********** FUNZIONALITÀ PRINCIPALI **********
  
  // Modalità scura
  const darkModeBtn = document.getElementById('darkModeBtn');
  darkModeBtn.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    darkModeBtn.textContent = document.body.classList.contains('dark-mode') ? 'Modalità Chiara' : 'Modalità Scura';
    localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
  });
  
  // Controlla se la modalità scura era attiva
  if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark-mode');
    darkModeBtn.textContent = 'Modalità Chiara';
  }
  
  // ********** CLASSIFICA **********
  
  function renderClassifica(year) {
    const classificaDiv = document.getElementById('classifica-bars');
    classificaDiv.innerHTML = '';
    const data = editionsData[year];
    if (!data) return;
    
    const maxPoints = Math.max(...Object.values(data.classifica));
    players.forEach(player => {
      const points = data.classifica[player] || 0;
      const lastPoints = data.lastSlamPoints[player] || 0;
      
      const item = document.createElement('div');
      item.setAttribute('role', 'listitem');
      item.className = 'player-bar';
      
      const nameDiv = document.createElement('div');
      nameDiv.className = 'name';
      nameDiv.textContent = player;
      
      // Aggiungo punti dell'ultimo slam in piccolo con segno +
      const lastPointsSpan = document.createElement('span');
      lastPointsSpan.className = 'last-slam-points';
      if(lastPoints > 0) {
        lastPointsSpan.textContent = ` (+${lastPoints})`;
      } else {
        lastPointsSpan.textContent = '';
      }
      nameDiv.appendChild(lastPointsSpan);
      
      const barContainer = document.createElement('div');
      barContainer.className = 'bar-container';
      
      const barFill = document.createElement('div');
      barFill.className = 'bar-fill';
      barFill.style.width = (points / maxPoints) * 100 + '%';
      
      const pointsLabel = document.createElement('div');
      pointsLabel.className = 'points';
      pointsLabel.textContent = points;
      
      barContainer.appendChild(barFill);
      barContainer.appendChild(pointsLabel);
      
      item.appendChild(nameDiv);
      item.appendChild(barContainer);
      
      // Aggiungi click per aprire le statistiche del giocatore
      item.addEventListener('click', () => openPlayerStats(player));
      item.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openPlayerStats(player);
        }
      });
      
      classificaDiv.appendChild(item);
    });
  }
  
  // ********** CALENDARIO **********
  
  function renderCalendario(year) {
    const container = document.getElementById('tournamentGrid');
    container.innerHTML = '';
    const data = editionsData[year];
    if (!data) return;
    
    data.tournaments.forEach(t => {
      const card = document.createElement('div');
      card.className = 'tournament-card';
      card.tabIndex = 0;
      card.setAttribute('role', 'listitem');
      card.setAttribute('aria-label', `${t.name} - ${t.season} - ${t.date}`);
      
      // Logo (placeholder)
      const logo = document.createElement('img');
      logo.className = 'tournament-logo';
      logo.alt = `${t.name} logo`;
      
      // Metto loghi diversi per ogni torneo (puoi cambiare link o metterli da file)
      switch(t.id){
        case 'theSinner':
          logo.src = 'img/logos/thesinner.jpg'; // o .jpg/.svg
          break;
        case 'heatCup':
          logo.src = 'img/logos/heatcup.jpg';
          break;
        case 'orangeTournament':
          logo.src = 'img/logos/orangetournament.jpg';
          break;
        case 'snowSlam':
          logo.src = 'img/logos/snowslam.jpg';
          break;
        default:
          logo.src = 'img/logos/default.png';
      }
      
      card.appendChild(logo);
      
      const infoWrapper = document.createElement('div');
      infoWrapper.className = 'tournament-info-wrapper';
      
      const nameElem = document.createElement('div');
      nameElem.innerHTML = `<strong>${t.name}</strong>`;
      
      const seasonElem = document.createElement('div');
      seasonElem.textContent = t.season;
      
      const dateElem = document.createElement('div');
      dateElem.textContent = t.date;
      
      infoWrapper.appendChild(nameElem);
      infoWrapper.appendChild(seasonElem);
      infoWrapper.appendChild(dateElem);
      
      card.appendChild(infoWrapper);
      
      if (t.played && t.winner) {
        const winnerIcon = document.createElement('div');
        winnerIcon.className = 'winner-check';
        winnerIcon.title = `Vinto da ${t.winner}`;
        winnerIcon.textContent = '✔️';
        card.appendChild(winnerIcon);
      }
      
      card.addEventListener('click', () => openPopup(t));
      card.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          openPopup(t);
        }
      });
      
      container.appendChild(card);
    });
  }
  
  // ********** NOTIZIE **********
  
  function renderNews() {
    newsContainer.innerHTML = '';
    let newsToShow = newsShowingAll ? newsData : newsData.slice(0, 3);
    
    newsToShow.forEach(news => {
        const card = document.createElement('div');
        card.className = 'news-card';
        
        const title = document.createElement('h3');
        title.className = 'news-title';
        title.textContent = news.title;
        
        const date = document.createElement('div');
        date.className = 'news-date';
        date.textContent = news.date;
        
        const content = document.createElement('p');
        content.textContent = news.content;
        
        card.appendChild(title);
        card.appendChild(date);
        card.appendChild(content);
        
        newsContainer.appendChild(card);
    });
    
    // Mostra il pulsante solo se ci sono più di 3 notizie E non stiamo già mostrando tutto
    if (!newsShowingAll && newsData.length > 3) {
        showAllNewsBtn.style.display = 'inline-block';
        reduceNewsBtn.style.display = 'none';
    } else if (newsShowingAll) {
        showAllNewsBtn.style.display = 'none';
        reduceNewsBtn.style.display = 'inline-block';
    } else {
        showAllNewsBtn.style.display = 'none';
        reduceNewsBtn.style.display = 'none';
    }
} // <-- Questa parentesi chiude la funzione renderNews

document.getElementById('reduceNewsBtn').addEventListener('click', () => {
    newsShowingAll = false;
    renderNews();
});

// FAQ functionality

document.querySelectorAll('.faq-question').forEach(button => {
  button.addEventListener('click', (e) => {
    // Aggiungi feedback al click
    button.classList.add('click-feedback');
    setTimeout(() => button.classList.remove('click-feedback'), 300);
    
    const faqItem = button.closest('.faq-item');
    const isActive = faqItem.classList.contains('active');
    
    // Chiudi tutte le altre FAQ
    document.querySelectorAll('.faq-item').forEach(item => {
      if (item !== faqItem) {
        item.classList.remove('active');
      }
    });
    
    // Apri/chiudi questa FAQ
    faqItem.classList.toggle('active', !isActive);
  });
});

// Chiudi FAQ quando si clicca altrove
document.addEventListener('click', (e) => {
  if (!e.target.closest('.faq-item')) {
    document.querySelectorAll('.faq-item').forEach(item => {
      item.classList.remove('active');
    });
  }
});

  // ********** GALLERIA **********
  
   const galleryMedia = [
    {type: 'video', src: 'video/0.mp4', alt: 'Tennis Cup - Trailer del torneo', thumb: 'img/gallery/0.jpg'},
    {type: 'image', src: 'img/gallery/1.jpg', alt: 'Fasi conclusive THE SINNER 2025'},
	{type: 'image', src: 'img/gallery/9.jpg', alt: 'Heat Cup, la strada è ancora lunga'},
	{type: 'image', src: 'img/gallery/7.jpg', alt: 'Heat Cup, non è solo un gioco'},
	{type: 'image', src: 'img/gallery/8.jpg', alt: 'Le affermazioni di Gioxter'},
    {type: 'image', src: 'img/gallery/2.jpg', alt: 'Usuds dream'},
    {type: 'image', src: 'img/gallery/3.jpg', alt: 'Usud motivation'},
    {type: 'image', src: 'img/gallery/4.jpg', alt: 'Usud pronostico'},
    {type: 'image', src: 'img/gallery/5.jpg', alt: 'Ancora Usud motivation'},
    {type: 'image', src: 'img/gallery/6.jpg', alt: 'Vincitore prima edizione THE SINNER'},
  ];
  
  const galleryThumbsDiv = document.getElementById('galleryThumbs');
  const showAllBtn = document.getElementById('showAllBtn');
  let galleryShowingAll = false;
  
function renderGallery() {
    galleryThumbsDiv.innerHTML = '';
    let mediaToShow = galleryShowingAll ? galleryMedia : galleryMedia.slice(0, 4);
    
    if (window.innerWidth <= 600) {
        galleryThumbsDiv.style.display = 'grid';
        galleryThumbsDiv.style.gridTemplateColumns = 'repeat(2, 1fr)';
        galleryThumbsDiv.style.gap = '10px';
        galleryThumbsDiv.style.padding = '0 10px';
    } else {
        galleryThumbsDiv.style.display = 'flex';
        galleryThumbsDiv.style.flexWrap = 'wrap';
        galleryThumbsDiv.style.justifyContent = 'center';
        galleryThumbsDiv.style.gap = '1rem';
    }
    
    mediaToShow.forEach((media, i) => {
        const container = document.createElement('div');
        container.className = 'gallery-item';
        container.style.marginBottom = '1rem';
        
        const title = document.createElement('div');
        title.textContent = media.alt;
        title.style.textAlign = 'center';
        title.style.marginBottom = '0.5rem';
        title.style.fontWeight = '600';
        title.style.fontSize = '0.9rem';
        
        container.appendChild(title);
        
        if(media.type === 'video') {
            container.innerHTML += `
                <div class="video-thumb" data-index="${i}" style="width:100%; height:120px;">
                    <img src="${media.thumb}" alt="${media.alt}" class="video-poster" style="width:100%; height:100%; object-fit:cover;">
                    <div class="play-icon">▶</div>
                </div>
            `;
            
            container.querySelector('.video-thumb').addEventListener('click', () => {
                openLightbox(i);
            });
        } else {
            const img = document.createElement('img');
            img.src = media.src;
            img.alt = media.alt;
            img.style.width = '100%';
            img.style.height = '120px';
            img.style.objectFit = 'cover';
            img.addEventListener('click', () => openLightbox(i));
            container.appendChild(img);
        }
        
        galleryThumbsDiv.appendChild(container);
    });
    
    if (!galleryShowingAll && galleryMedia.length > 4) {
        showAllBtn.style.display = 'inline-block';
        reduceBtn.style.display = 'none';
    } else if (galleryShowingAll) {
        showAllBtn.style.display = 'none';
        reduceBtn.style.display = 'inline-block';
    } else {
        showAllBtn.style.display = 'none';
        reduceBtn.style.display = 'none';
    }
}
  
  showAllBtn.addEventListener('click', () => {
    galleryShowingAll = true;
    renderGallery();
  });
  document.getElementById('reduceBtn').addEventListener('click', () => {
    galleryShowingAll = false;
    renderGallery();
});
  // ********** LIGHTBOX **********
  
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = lightbox.querySelector('img');
  const lightboxClose = document.getElementById('lightbox-close');
  let currentVideoElement = null; // Variabile globale per tenere traccia del video corrente

function openLightbox(index) {
    const media = galleryMedia[index];
    lightbox.classList.add('active');
    
    lightbox.innerHTML = `
        <button id="lightbox-close">&times;</button>
        ${media.type === 'video' ? 
            `<video controls id="lightbox-video">
                <source src="${media.src}" type="video/mp4">
                Your browser does not support the video tag.
            </video>` : 
            `<img src="${media.src}" alt="${media.alt}" />`}
    `;
    
    // Se è un video, ottieni l'elemento e avvia la riproduzione
    if (media.type === 'video') {
        currentVideoElement = document.getElementById('lightbox-video');
        currentVideoElement.play();
    }
    
    document.getElementById('lightbox-close').addEventListener('click', () => {
        closeLightbox();
    });
}

function closeLightbox() {
    // Se c'è un video in riproduzione, fermalo e resetta
    if (currentVideoElement) {
        currentVideoElement.pause();
        currentVideoElement.currentTime = 0;
        currentVideoElement = null;
    }
    lightbox.classList.remove('active');
}

// Modifica anche l'event listener per il click sullo sfondo
lightbox.addEventListener('click', e => {
    if (e.target === lightbox) {
        closeLightbox();
    }
});

// Modifica l'event listener per il pulsante di chiusura
lightboxClose.addEventListener('click', closeLightbox);
  
  // ********** PLAYER STATS **********
  
  function openPlayerStats(player) {
    // Nascondi la pagina principale
    document.querySelector('main').style.display = 'none';
    document.querySelector('footer').style.display = 'none';
    
    // Mostra la pagina delle statistiche
    const statsPage = document.getElementById('playerStatsPage');
    statsPage.style.display = 'block';
    
    // Imposta i dati del giocatore
    document.getElementById('playerName').textContent = player;
    const avatarImg = document.getElementById('playerAvatar');
    avatarImg.src = playerAvatars[player] || 'img/avatars/default.jpg';
    avatarImg.alt = `Avatar di ${player}`;
    
    // Aggiungi evento click per aprire l'avatar in grande
    avatarImg.addEventListener('click', () => {
        const lightbox = document.getElementById('avatar-lightbox');
        const lightboxImg = lightbox.querySelector('img');
        
        lightboxImg.src = avatarImg.src;
        lightboxImg.alt = avatarImg.alt;
        lightbox.classList.add('active');
    });
    
    // Resetta il select degli avversari
    const opponentSelect = document.getElementById('opponentSelect');
    opponentSelect.value = '';
    document.getElementById('headToHeadStats').style.display = 'none';
    
    // Calcola e mostra le statistiche
    calculatePlayerStats(player);
    populateOpponentSelect(player);
    
    // Aggiungi event listeners per i filtri degli scontri diretti
    document.querySelectorAll('[data-h2h-filter]').forEach(btn => {
        btn.addEventListener('click', function() {
            const player = document.getElementById('playerName').textContent;
            const opponentSelect = document.getElementById('opponentSelect');
            const opponent = opponentSelect.value;
            
            if (!opponent) return;
            
            // Aggiorna bottoni attivi
            document.querySelectorAll('[data-h2h-filter]').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Ricalcola statistiche con il nuovo filtro
            calculateHeadToHeadStats(player, opponent, this.dataset.h2hFilter);
        });
    });
}
 // Chiudi lightbox avatar
document.getElementById('avatar-lightbox-close').addEventListener('click', () => {
    document.getElementById('avatar-lightbox').classList.remove('active');
});

// Chiudi lightbox avatar cliccando sullo sfondo
document.getElementById('avatar-lightbox').addEventListener('click', (e) => {
    if (e.target === e.currentTarget) {
        e.currentTarget.classList.remove('active');
    }
});
// Aggiungi feedback al click sull'avatar
document.getElementById('playerAvatar').addEventListener('click', (e) => {
    e.currentTarget.classList.add('click-feedback');
    setTimeout(() => {
        e.currentTarget.classList.remove('click-feedback');
    }, 300);
});
 function calculatePlayerStats(player, filter = 'all') {
    // Reset dei valori
    document.getElementById('torneiVinti').textContent = '0';
    document.getElementById('matchGiocati').textContent = '0';
    document.getElementById('matchVinti').textContent = '0';
    document.getElementById('percentualeVittorie').textContent = '0%';
    document.getElementById('setVinti').textContent = '0';
    document.getElementById('setPersi').textContent = '0';
    document.getElementById('gameVinti').textContent = '0';
    document.getElementById('gamePersi').textContent = '0';
    document.getElementById('trophiesContainer').innerHTML = '';

    let stats = {
        torneiVinti: 0,
        matchGiocati: 0,
        matchVinti: 0,
        setVinti: 0,
        setPersi: 0,
        gameVinti: 0,
        gamePersi: 0,
        torneiGiocati: 0
    };

    // Analisi tornei
    Object.values(editionsData).forEach(edition => {
        edition.tournaments.forEach(t => {
            let hasPlayedInTournament = false;
            
            if (t.played && t.winner === player) {
                stats.torneiVinti++;
                
                const trophy = document.createElement('div');
                trophy.className = 'trophy';
                trophy.innerHTML = `
                    <div class="trophy-icon">🏆</div>
                    <strong>${t.name}</strong><br>
                    ${t.season} ${t.date}
                `;
                document.getElementById('trophiesContainer').appendChild(trophy);
            }

            // Analisi match
            if (filter === 'all' || filter === 'slam') {
                [...t.phaseGironi, ...t.phaseTabellone].forEach(phase => {
                    phase.matches.forEach(m => {
                        if ((m.player1 === player || m.player2 === player) && m.winner) {
                            hasPlayedInTournament = true;
                            stats.matchGiocati++;
                            if (m.winner === player) stats.matchVinti++;
                            
                            // Calcola set e game
								m.sets.forEach(set => {
									// Per ogni set nel match, aggiungi il numero effettivo di set giocati
									if (m.player1 === player) {
										stats.setVinti += set.player1;
										stats.setPersi += set.player2;
									} else {
										stats.setVinti += set.player2;
										stats.setPersi += set.player1;
									}
								});
                            
                            // Aggiungi i game totali
                            if (m.totalGames) {
                                if (m.player1 === player) {
                                    stats.gameVinti += m.totalGames.player1;
                                    stats.gamePersi += m.totalGames.player2;
                                } else {
                                    stats.gameVinti += m.totalGames.player2;
                                    stats.gamePersi += m.totalGames.player1;
                                }
                            }
                        }
                    });
                });
                
                if (hasPlayedInTournament) {
                    stats.torneiGiocati++;
                }
            }
        });
    });

    // Analisi amichevoli
   if (filter === 'all' || filter === 'friendly') {
    friendlyMatches.forEach(m => {
        if (m.player1 === player || m.player2 === player) {
            stats.matchGiocati++;
            if (m.winner === player) stats.matchVinti++;
            
            // Calcola set e game per amichevoli
            if (m.sets) {
                m.sets.forEach(set => {
                    if (m.player1 === player) {
                        stats.setVinti += set.player1;
                        stats.setPersi += set.player2;
                    } else {
                        stats.setVinti += set.player2;
                        stats.setPersi += set.player1;
                    }
                });
            }
            
            // Aggiungi i game totali per amichevoli
            if (m.totalGames) {
                if (m.player1 === player) {
                    stats.gameVinti += m.totalGames.player1;
                    stats.gamePersi += m.totalGames.player2;
                } else {
                    stats.gameVinti += m.totalGames.player2;
                    stats.gamePersi += m.totalGames.player1;
                }
            }
        }
    });
	}

    // Calcola percentuale
    const percentuale = stats.matchGiocati > 0 
        ? Math.round((stats.matchVinti / stats.matchGiocati) * 100)
        : 0;

    // Aggiorna UI
    document.getElementById('torneiVinti').textContent = stats.torneiVinti;
    document.getElementById('matchGiocati').textContent = stats.matchGiocati;
    document.getElementById('matchVinti').textContent = stats.matchVinti;
    document.getElementById('percentualeVittorie').textContent = `${percentuale}%`;
    document.getElementById('setVinti').textContent = stats.setVinti;
    document.getElementById('setPersi').textContent = stats.setPersi;
    document.getElementById('gameVinti').textContent = stats.gameVinti;
    document.getElementById('gamePersi').textContent = stats.gamePersi;
}
  
  // Filtri statistiche
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const player = document.getElementById('playerName').textContent;
      const filter = btn.dataset.filter;
      
      // Aggiorna bottoni attivi
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      
      // Pulisci i trofei
      document.getElementById('trophiesContainer').innerHTML = '';
      
      // Ricalcola statistiche
      calculatePlayerStats(player, filter);
    });
  });
  
  // Torna indietro dalle statistiche
  document.getElementById('backBtn').addEventListener('click', (e) => {
      e.preventDefault();
    // Resetta il select degli avversari
    document.getElementById('opponentSelect').value = '';
    document.getElementById('playerStatsPage').style.display = 'none';
    document.querySelector('main').style.display = 'block';
    document.querySelector('footer').style.display = 'block';
  });
  
  // ********** SIMULATORE **********
  
  function openSimulator() {
    // Nascondi la pagina principale
    document.querySelector('main').style.display = 'none';
    document.querySelector('footer').style.display = 'none';
    
    // Mostra la pagina del simulatore
    document.getElementById('simulatorPage').style.display = 'block';
  }
  
  // Torna indietro dal simulatore
  document.getElementById('simulatorBackBtn').addEventListener('click', (e) => {
    e.preventDefault();
    document.getElementById('simulatorPage').style.display = 'none';
    document.querySelector('main').style.display = 'block';
    document.querySelector('footer').style.display = 'block';
  });
  
  // Simula risultato
 // Sostituisci la funzione esistente con questa:
document.getElementById('simulateBtn').addEventListener('click', () => {
  const tournamentId = document.getElementById('simulateTournament').value;
  
  // Ottieni le posizioni selezionate
  const positions = {
    1: document.getElementById('pos1').value,
    2: document.getElementById('pos2').value,
    3: document.getElementById('pos3').value,
    4: document.getElementById('pos4').value,
    5: document.getElementById('pos5').value
  };
  
  // Verifica che non ci siano giocatori duplicati
  const players = Object.values(positions);
  const uniquePlayers = [...new Set(players)];
  
  if (players.length !== uniquePlayers.length) {
    alert("Errore: hai selezionato lo stesso giocatore in più posizioni!");
    return;
  }
  
  // Trova il torneo selezionato
  const tournament = editionsData['2025'].tournaments.find(t => t.id === tournamentId);
  if (!tournament) return;
  
  // Punti da assegnare per ogni posizione (puoi modificare questi valori)
  const pointsDistribution = {
    1: 1000, // 1° posto
    2: 600,  // 2° posto
    3: 400,  // 3° posto
    4: 250,  // 4° posto
    5: 150   // 5° posto
  };
  
  // Simula la classifica (parti dalla classifica attuale)
  const simulatedRanking = {...editionsData['2025'].classifica};
  
  // Assegna i punti in base alle posizioni
  for (const [position, player] of Object.entries(positions)) {
    simulatedRanking[player] += pointsDistribution[position];
  }
  
  // Ordina la classifica simulata
  const sortedRanking = Object.entries(simulatedRanking)
    .sort((a, b) => b[1] - a[1])
    .reduce((acc, [player, points]) => {
      acc[player] = points;
      return acc;
    }, {});
  
  // Mostra il risultato
  const resultDiv = document.getElementById('simulationResult');
  resultDiv.style.display = 'block';
  resultDiv.innerHTML = `
    <h3>Classifica simulata dopo ${tournament.name}:</h3>
    <ol>
      ${Object.entries(sortedRanking).map(([player, points]) => `
        <li><strong>${player}</strong>: ${points} punti</li>
      `).join('')}
    </ol>
    <p>Punti assegnati:</p>
    <ul>
      <li>1° ${positions[1]}: +${pointsDistribution[1]} punti</li>
      <li>2° ${positions[2]}: +${pointsDistribution[2]} punti</li>
      <li>3° ${positions[3]}: +${pointsDistribution[3]} punti</li>
      <li>4° ${positions[4]}: +${pointsDistribution[4]} punti</li>
      <li>5° ${positions[5]}: +${pointsDistribution[5]} punti</li>
    </ul>
  `;
});
  
  // ********** POPUP DETTAGLI TORNEO **********
  
  const popup = document.getElementById('popup');
  const popupTitle = document.getElementById('popup-title');
  const popupContent = document.getElementById('popup-content');
  const detailsBtn = document.getElementById('detailsBtn');
  const popupDetails = document.getElementById('popup-details');
  const popupCloseBtn = document.getElementById('popup-close');
  
  let currentTournament = null;
  function closePopup() {
    popup.classList.remove('active');
    popup.setAttribute('aria-hidden', 'true');
    popupDetails.style.display = 'none';
}
function populateOpponentSelect(currentPlayer) {
    const opponentSelect = document.getElementById('opponentSelect');
    opponentSelect.innerHTML = '';
    
    // Aggiungi un'opzione vuota iniziale
    const defaultOption = document.createElement('option');
    defaultOption.value = '';
    defaultOption.textContent = 'Seleziona avversario';
    opponentSelect.appendChild(defaultOption);
    
    // Aggiungi tutti gli altri giocatori tranne quello corrente
    players.forEach(player => {
        if (player !== currentPlayer) {
            const option = document.createElement('option');
            option.value = player;
            option.textContent = player;
            opponentSelect.appendChild(option);
        }
    });
    
    // Aggiungi event listener per il cambio di avversario
    opponentSelect.addEventListener('change', function() {
        const opponent = this.value;
        if (opponent) {
            const activeFilter = document.querySelector('[data-h2h-filter].active')?.dataset.h2hFilter || 'all';
            calculateHeadToHeadStats(currentPlayer, opponent, activeFilter);
        } else {
            document.getElementById('headToHeadStats').style.display = 'none';
        }
    });
}
function calculateHeadToHeadStats(player1, player2, filter = 'all') {
    let stats = {
        totalMatches: 0,
        player1Wins: 0,
        player2Wins: 0,
        player1Sets: 0,
        player2Sets: 0,
        player1Games: 0,
        player2Games: 0,
        matches: []
    };

    // Analizza i tornei
    Object.values(editionsData).forEach(edition => {
        edition.tournaments.forEach(t => {
            if (filter === 'all' || filter === 'slam') {
                [...t.phaseGironi, ...t.phaseTabellone].forEach(phase => {
                    phase.matches.forEach(m => {
                        if ((m.player1 === player1 && m.player2 === player2) || 
                             (m.player1 === player2 && m.player2 === player1)) {
                            stats.totalMatches++;
                            if (m.winner === player1) stats.player1Wins++;
                            if (m.winner === player2) stats.player2Wins++;
                            
                            // Calcola set e game
                            if (m.sets) {
                                m.sets.forEach(set => {
                                    if (m.player1 === player1) {
                                        stats.player1Sets += set.player1;
                                        stats.player2Sets += set.player2;
                                    } else {
                                        stats.player1Sets += set.player2;
                                        stats.player2Sets += set.player1;
                                    }
                                });
                            }
                            
                            // Aggiungi i game totali
                            if (m.totalGames) {
                                if (m.player1 === player1) {
                                    stats.player1Games += m.totalGames.player1;
                                    stats.player2Games += m.totalGames.player2;
                                } else {
                                    stats.player1Games += m.totalGames.player2;
                                    stats.player2Games += m.totalGames.player1;
                                }
                            }
                            
                            // Aggiungi alla cronologia match
							if (m.winner) {
                            stats.matches.push({
                                date: m.date,
                                player1: m.player1,
                                player2: m.player2,
                                winner: m.winner,
                                score: m.score,
                                tournament: t.name
                            });
						  }
                        }
                    });
                });
            }
        });
    });

    // Analizza le amichevoli
    if (filter === 'all' || filter === 'friendly') {
        friendlyMatches.forEach(m => {
           if ((m.player1 === player1 && m.player2 === player2) || 
				(m.player1 === player2 && m.player2 === player1)) {
                stats.totalMatches++;
                if (m.winner === player1) stats.player1Wins++;
                if (m.winner === player2) stats.player2Wins++;
                
                // Calcola set e game per amichevoli
                if (m.sets) {
                    m.sets.forEach(set => {
                        if (m.player1 === player1) {
                            stats.player1Sets += set.player1;
                            stats.player2Sets += set.player2;
                        } else {
                            stats.player1Sets += set.player2;
                            stats.player2Sets += set.player1;
                        }
                    });
                }
                
                // Aggiungi i game totali per amichevoli
                if (m.totalGames) {
                    if (m.player1 === player1) {
                        stats.player1Games += m.totalGames.player1;
                        stats.player2Games += m.totalGames.player2;
                    } else {
                        stats.player1Games += m.totalGames.player2;
                        stats.player2Games += m.totalGames.player1;
                    }
                }
                
                // Aggiungi alla cronologia match
				if (m.winner){
                stats.matches.push({
                    date: m.date,
                    player1: m.player1,
                    player2: m.player2,
                    winner: m.winner,
                    score: m.score,
                    tournament: 'Amichevole'
                });
			  }
            }
        });
    }

    // Mostra le statistiche
    displayHeadToHeadStats(player1, player2, stats);
}


// Aggiungi questa funzione per visualizzare le statistiche
function displayHeadToHeadStats(player1, player2, stats) {
    const container = document.getElementById('headToHeadStats');
    container.style.display = 'grid';
    container.innerHTML = '';

    // 1. PRENDI I VALORI DAL "BILANCIO TESTA A TESTA"
    const player1Wins = stats.player1Wins;
    const player2Wins = stats.player2Wins;
    const totalMatches = player1Wins + player2Wins;

    // 2. CALCOLA PERCENTUALI SOLO CON QUESTI NUMERI
    const player1Percent = totalMatches > 0 ? Math.round((player1Wins / totalMatches) * 100) : 50;
    const player2Percent = 100 - player1Percent;

    // 3. Statistiche principali
    const mainStats = `
        <div class="h2h-stat-card" style="grid-column:1/-1; text-align:center;">
            <div style="font-size:1.2rem; margin-bottom:0.5rem;">Bilancio testa a testa</div>
            <div style="display:flex; justify-content:center; align-items:center; gap:1rem;">
                <div style="text-align:right;">
                    <div style="font-weight:600;">${player1}</div>
                    <div>${player1Wins} vittorie</div>
                </div>
                <div style="font-size:1.5rem; font-weight:700;">${player1Wins}–${player2Wins}</div>
                <div style="text-align:left;">
                    <div style="font-weight:600;">${player2}</div>
                    <div>${player2Wins} vittorie</div>
                </div>
            </div>
        </div>

        ${stats.setVinti > 0 || stats.setPersi > 0 ? `
        <div class="h2h-stat-card">
            <div class="h2h-stat-label">Set vinti</div>
            <div class="h2h-stat-value">${stats.setVinti}–${stats.setPersi}</div>
        </div>
        ` : ''}

        ${stats.gameVinti > 0 || stats.gamePersi > 0 ? `
        <div class="h2h-stat-card">
            <div class="h2h-stat-label">Game vinti</div>
            <div class="h2h-stat-value">${stats.gameVinti}–${stats.gamePersi}</div>
        </div>
        ` : ''}

        <div class="h2h-stat-card" style="grid-column:1/-1;">
            <div style="display:flex; height:30px; background:#e2e8f0; border-radius:15px; overflow:hidden; margin-top:1rem;">
                <div style="width:${player1Percent}%; background:var(--green); display:flex; justify-content:center; align-items:center; color:white; font-weight:600;">
                    ${player1Percent}%
                </div>
                <div style="width:${player2Percent}%; background:var(--blue); display:flex; justify-content:center; align-items:center; color:white; font-weight:600;">
                    ${player2Percent}%
                </div>
            </div>
            <div style="display:flex; justify-content:space-between; margin-top:0.5rem;">
                <span>${player1}</span>
                <span>${player2}</span>
            </div>
        </div>
    `;

    container.innerHTML = mainStats;

    // Aggiungi cronologia match
    if (stats.matches.length > 0) {
        const historyDiv = document.createElement('div');
        historyDiv.className = 'h2h-stat-card';
        historyDiv.style.gridColumn = '1/-1';
        
        historyDiv.innerHTML = '<div style="font-weight:600; margin-bottom:0.5rem;">Cronologia match</div>';
        
        const matchesList = document.createElement('div');
        matchesList.className = 'h2h-match-history';

        // Ordina per data
        stats.matches.sort((a, b) => 
            new Date(b.date.split('/').reverse().join('-')) - 
            new Date(a.date.split('/').reverse().join('-'))
        );

        stats.matches.forEach(match => {
            const matchDiv = document.createElement('div');
            matchDiv.className = 'h2h-match-item';
            
            const winnerClass = match.winner === player1 ? 'h2h-match-winner' : '';
            const tournamentInfo = match.tournament !== 'Amichevole' ? ` (${match.tournament})` : '';
            
            matchDiv.innerHTML = `
                <div class="${winnerClass}">${match.winner} ha vinto ${match.score}</div>
                <div class="h2h-match-date">${match.date}${tournamentInfo}</div>
            `;
            
            matchesList.appendChild(matchDiv);
        });

        historyDiv.appendChild(matchesList);
        container.appendChild(historyDiv);
    }

    // Animazione
    container.style.opacity = '0';
    setTimeout(() => {
        container.style.transition = 'opacity 0.3s ease';
        container.style.opacity = '1';
    }, 10);
}

function openPopup(t) {
    currentTournament = t;
    popupTitle.textContent = t.name;
    popupContent.textContent = t.description || 'Nessuna descrizione disponibile.';
    popupDetails.style.display = 'none';
    popupDetails.innerHTML = '';
    
    if(t.id === 'theSinner' || t.id === 'heatCup') {
        detailsBtn.style.display = 'inline-block';
        standingsBtn.style.display = 'inline-block';
    } else {
        detailsBtn.style.display = 'none';
        standingsBtn.style.display = 'none';
    }
    
    // Reset dello stato del popup
 popup.classList.add('active');
    popup.removeAttribute('aria-hidden');
    
    // Forza il browser a ricostruire il layout (fix per animazioni bloccate)
    void popup.offsetWidth;
}
		  document.getElementById('standingsBtn').addEventListener('click', () => {
    if (!currentTournament) return;
    
    popupDetails.style.display = 'block';
    popupDetails.innerHTML = '<h3>Classifica Torneo</h3>';
    
    // Classifica fissa basata sui risultati del torneo
    let standings = [];
    
    if(currentTournament.id === 'theSinner') {
        standings = [
            '1. Gioxter 🏆',
            '2. Enrico',
            '3. Usud',
            '4. Paolo',
            '5. Michele'
        ];
    } else {
        standings = ['Classifica non disponibile per questo torneo'];
    }
    
    // Mostra la classifica
    popupDetails.innerHTML += '<div style="margin-top:1rem; line-height:2;">';
    standings.forEach(position => {
        popupDetails.innerHTML += `
            <div style="padding:4px 0; border-bottom:1px solid #eee;">
                ${position}
            </div>
        `;
    });
    popupDetails.innerHTML += '</div>';
});
detailsBtn.addEventListener('click', () => {
    if (!currentTournament) return;
    
    popupDetails.style.display = 'block';
    popupDetails.innerHTML = '<h3>Dettagli Torneo</h3>';
    
    if(currentTournament.phaseGironi.length > 0){
        popupDetails.innerHTML += '<h4>Fase a gironi</h4>';
        
        currentTournament.phaseGironi[0].matches.forEach(m => {
            const matchDiv = document.createElement('div');
            matchDiv.className = 'match-container';
            
            // Header con giocatori e data
            const headerDiv = document.createElement('div');
            headerDiv.className = 'match-header';
            
            const playersDiv = document.createElement('div');
            playersDiv.className = 'match-players';
            playersDiv.textContent = `${m.player1} vs ${m.player2}`;
            
            const dateDiv = document.createElement('div');
            dateDiv.className = 'match-date';
            dateDiv.textContent = m.date;
            
            headerDiv.appendChild(playersDiv);
            headerDiv.appendChild(dateDiv);
            matchDiv.appendChild(headerDiv);
            
            // Se la partita è stata giocata
            if (m.winner) {
                const resultDiv = document.createElement('div');
                resultDiv.innerHTML = `
                    <div>📊 Risultato: <strong>${m.score}</strong></div>
                    <div>🎉 Vincitore: ${m.winner}</div>
                `;
                matchDiv.appendChild(resultDiv);
            } 
            // Se la partita deve ancora essere giocata
            else {
                const predictionDiv = document.createElement('div');
                predictionDiv.className = 'match-prediction';
                
               predictionDiv.innerHTML = `
				  <div class="prediction-title">Pronostico:</div>
				  <div class="prediction-options">
					  <button class="prediction-btn green-btn" data-choice="${m.player1}">${m.player1}</button>
					  <button class="prediction-btn blue-btn" data-choice="${m.player2}">${m.player2}</button>
				  </div>
				  <div class="prediction-results-single">
					  <div class="prediction-bar-single">
						  <div class="prediction-fill-left" style="width:50%">${m.player1}</div>
						  <div class="prediction-fill-right" style="width:50%">${m.player2}</div>
					  </div>
				  </div>
				`;
                
                matchDiv.appendChild(predictionDiv);
                
                // Aggiungi event listeners ai pulsanti di pronostico
                const predictionBtns = predictionDiv.querySelectorAll('.prediction-btn');
               // Sostituisci tutto il codice dentro predictionBtns.forEach con questo:
				predictionBtns.forEach(btn => {
    btn.addEventListener('click', function() {
        const predictionDiv = this.closest('.match-prediction');
        const predictionOptions = predictionDiv.querySelector('.prediction-options');
        const resultsDiv = predictionDiv.querySelector('.prediction-results-single');
        
        // Nascondi i pulsanti di scelta
        predictionOptions.style.display = 'none';
        
        // Mostra i risultati
        resultsDiv.style.display = 'block';
        
        const leftFill = resultsDiv.querySelector('.prediction-fill-left');
        const rightFill = resultsDiv.querySelector('.prediction-fill-right');
        
        // Reset delle barre
        leftFill.style.width = '0%';
        rightFill.style.width = '0%';
        leftFill.textContent = '';
        rightFill.textContent = '';
        
        // Calcola le probabilità
        const player1 = m.player1;
        const player2 = m.player2;
        const tournamentId = currentTournament.id;
        
        const player1Prob = calculateWinProbability(player1, player2, tournamentId);
        const player2Prob = 1 - player1Prob;
        
        const player1Percent = Math.round(player1Prob * 100);
        const player2Percent = 100 - player1Percent;
        
        // Animazione
        let start = null;
        const duration = 1000;
        
        function animate(timestamp) {
            if (!start) start = timestamp;
            const progress = Math.min((timestamp - start) / duration, 1);
            
            leftFill.style.width = `${progress * player1Percent}%`;
            rightFill.style.width = `${progress * player2Percent}%`;
            
            if (progress < 1) {
                window.requestAnimationFrame(animate);
            } else {
                leftFill.textContent = player1Percent + '%';
                rightFill.textContent = player2Percent + '%';
                
                leftFill.classList.add('active-shine');
                rightFill.classList.add('active-shine');
                
                setTimeout(() => {
                    leftFill.classList.remove('active-shine');
                    rightFill.classList.remove('active-shine');
                }, 700);
            }
        }
        
        window.requestAnimationFrame(animate);
    });
});  
            popupDetails.appendChild(matchDiv);
        }
    });
    
    if(currentTournament.phaseTabellone.length > 0){
        popupDetails.innerHTML += '<h4>Fase a tabellone</h4>';
        
        currentTournament.phaseTabellone.forEach(round => {
            popupDetails.innerHTML += `<h5>${round.round}</h5>`;
            
            round.matches.forEach(m => {
                const matchDiv = document.createElement('div');
                matchDiv.className = 'match-container';
                
                // Header con giocatori e data
                const headerDiv = document.createElement('div');
                headerDiv.className = 'match-header';
                
                const playersDiv = document.createElement('div');
                playersDiv.className = 'match-players';
                playersDiv.textContent = `${m.player1} vs ${m.player2}`;
                
                const dateDiv = document.createElement('div');
                dateDiv.className = 'match-date';
                dateDiv.textContent = m.date;
                
                headerDiv.appendChild(playersDiv);
                headerDiv.appendChild(dateDiv);
                matchDiv.appendChild(headerDiv);
                
                // Se la partita è stata giocata
                if (m.winner) {
                    const resultDiv = document.createElement('div');
                    resultDiv.innerHTML = `
                        <div>📊 Risultato: <strong>${m.score}</strong></div>
                        <div>🎉 Vincitore: ${m.winner}</div>
                    `;
                    matchDiv.appendChild(resultDiv);
                } 
                // Se la partita deve ancora essere giocata
                else {
                    const predictionDiv = document.createElement('div');
                    predictionDiv.className = 'match-prediction';
                    
                    predictionDiv.innerHTML = `
                        <div class="prediction-title">Pronostico:</div>
                        <div class="prediction-options">
                            <button class="prediction-btn" data-choice="${m.player1}">${m.player1}</button>
                            <button class="prediction-btn" data-choice="${m.player2}">${m.player2}</button>
                        </div>
                        <div class="prediction-results-single">
                            <div class="prediction-bar-single">
                                <div class="prediction-fill-left" style="width:50%">${m.player1}</div>
                                <div class="prediction-fill-right" style="width:50%">${m.player2}</div>
                            </div>
                        </div>
                    `;
                    
                    matchDiv.appendChild(predictionDiv);
                    
                    // Aggiungi event listeners ai pulsanti di pronostico
                    const predictionBtns = predictionDiv.querySelectorAll('.prediction-btn');
              
                }
                
                popupDetails.appendChild(matchDiv);
            });
        });
    }
	}
},
  popupCloseBtn.addEventListener('click', () => {
    popup.classList.remove('active');
    popup.setAttribute('aria-hidden', 'true');
    popupDetails.style.display = 'none';
  }));

  detailsBtn.addEventListener('click', () => {
    if (!currentTournament) return;
    
    popupDetails.style.display = 'block';
    popupDetails.innerHTML = '<h3>Dettagli Torneo</h3>';
    
    if(currentTournament.phaseGironi.length > 0){
        popupDetails.innerHTML += '<h4>Fase a gironi</h4>';
        
        currentTournament.phaseGironi[0].matches.forEach(m => {
            const matchDiv = document.createElement('div');
            matchDiv.className = 'match-container';
            
            // Header con giocatori e data
            const headerDiv = document.createElement('div');
            headerDiv.className = 'match-header';
            
            const playersDiv = document.createElement('div');
            playersDiv.className = 'match-players';
            playersDiv.textContent = `${m.player1} vs ${m.player2}`;
            
            const dateDiv = document.createElement('div');
            dateDiv.className = 'match-date';
            dateDiv.textContent = m.date;
            
            headerDiv.appendChild(playersDiv);
            headerDiv.appendChild(dateDiv);
            matchDiv.appendChild(headerDiv);
            
            // Se la partita è stata giocata
            if (m.winner) {
                const resultDiv = document.createElement('div');
                resultDiv.innerHTML = `
                    <div>📊 Risultato: <strong>${m.score}</strong></div>
                    <div>🎉 Vincitore: ${m.winner}</div>
                `;
                matchDiv.appendChild(resultDiv);
            } 
            // Se la partita deve ancora essere giocata
            else {
                const predictionDiv = document.createElement('div');
                predictionDiv.className = 'match-prediction';
                
                predictionDiv.innerHTML = `
                    <div class="prediction-title">Pronostico:</div>
                    <div class="prediction-options">
                        <button class="prediction-btn green-btn" data-choice="${m.player1}">${m.player1}</button>
                        <button class="prediction-btn blue-btn" data-choice="${m.player2}">${m.player2}</button>
                    </div>
                    <div class="prediction-results-single">
                        <div class="prediction-bar-single">
                            <div class="prediction-fill-left" style="width:50%">${m.player1}</div>
                            <div class="prediction-fill-right" style="width:50%">${m.player2}</div>
                        </div>
                    </div>
                `;
                
                matchDiv.appendChild(predictionDiv);
                
                // Aggiungi event listeners ai pulsanti di pronostico
                const predictionBtns = predictionDiv.querySelectorAll('.prediction-btn');
                predictionBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        const predictionDiv = this.closest('.match-prediction');
                        const predictionOptions = predictionDiv.querySelector('.prediction-options');
                        const resultsDiv = predictionDiv.querySelector('.prediction-results-single');
                        
                        // Nascondi i pulsanti di scelta
                        predictionOptions.style.display = 'none';
                        
                        // Mostra i risultati
                        resultsDiv.style.display = 'block';
                        
                        const leftFill = resultsDiv.querySelector('.prediction-fill-left');
                        const rightFill = resultsDiv.querySelector('.prediction-fill-right');
                        
                        // Reset delle barre
                        leftFill.style.width = '0%';
                        rightFill.style.width = '0%';
                        leftFill.textContent = '';
                        rightFill.textContent = '';
                        
                        // Calcola le probabilità
                        const player1 = m.player1;
                        const player2 = m.player2;
                        const tournamentId = currentTournament.id;
                        
                        const player1Prob = calculateWinProbability(player1, player2, tournamentId);
                        const player2Prob = 1 - player1Prob;
                        
                        const player1Percent = Math.round(player1Prob * 100);
                        const player2Percent = 100 - player1Percent;
                        
                        // Animazione
                        let start = null;
                        const duration = 1000;
                        
                        function animate(timestamp) {
                            if (!start) start = timestamp;
                            const progress = Math.min((timestamp - start) / duration, 1);
                            
                            leftFill.style.width = `${progress * player1Percent}%`;
                            rightFill.style.width = `${progress * player2Percent}%`;
                            
                            if (progress < 1) {
                                window.requestAnimationFrame(animate);
                            } else {
                                leftFill.textContent = player1Percent + '%';
                                rightFill.textContent = player2Percent + '%';
                                
                                leftFill.classList.add('active-shine');
                                rightFill.classList.add('active-shine');
                                
                                setTimeout(() => {
                                    leftFill.classList.remove('active-shine');
                                    rightFill.classList.remove('active-shine');
                                }, 700);
                            }
                        }
                        
                        window.requestAnimationFrame(animate);
                    });
                });  
            }
            popupDetails.appendChild(matchDiv);
        });
    }
    
    if(currentTournament.phaseTabellone.length > 0){
        popupDetails.innerHTML += '<h4>Fase a tabellone</h4>';
        
        currentTournament.phaseTabellone.forEach(round => {
            popupDetails.innerHTML += `<h5>${round.round}</h5>`;
            
            round.matches.forEach(m => {
                const matchDiv = document.createElement('div');
                matchDiv.className = 'match-container';
                
                // Header con giocatori e data
                const headerDiv = document.createElement('div');
                headerDiv.className = 'match-header';
                
                const playersDiv = document.createElement('div');
                playersDiv.className = 'match-players';
                playersDiv.textContent = `${m.player1} vs ${m.player2}`;
                
                const dateDiv = document.createElement('div');
                dateDiv.className = 'match-date';
                dateDiv.textContent = m.date;
                
                headerDiv.appendChild(playersDiv);
                headerDiv.appendChild(dateDiv);
                matchDiv.appendChild(headerDiv);
                
                // Se la partita è stata giocata
                if (m.winner) {
                    const resultDiv = document.createElement('div');
                    resultDiv.innerHTML = `
                        <div>📊 Risultato: <strong>${m.score}</strong></div>
                        <div>🎉 Vincitore: ${m.winner}</div>
                    `;
                    matchDiv.appendChild(resultDiv);
                } 
                // Se la partita deve ancora essere giocata
                else {
                    const predictionDiv = document.createElement('div');
                    predictionDiv.className = 'match-prediction';
                    
                    predictionDiv.innerHTML = `
                        <div class="prediction-title">Pronostico:</div>
                        <div class="prediction-options">
                            <button class="prediction-btn" data-choice="${m.player1}">${m.player1}</button>
                            <button class="prediction-btn" data-choice="${m.player2}">${m.player2}</button>
                        </div>
                        <div class="prediction-results-single">
                            <div class="prediction-bar-single">
                                <div class="prediction-fill-left" style="width:50%">${m.player1}</div>
                                <div class="prediction-fill-right" style="width:50%">${m.player2}</div>
                            </div>
                        </div>
                    `;
                    
                    matchDiv.appendChild(predictionDiv);
                    
                    // Aggiungi event listeners ai pulsanti di pronostico
                    const predictionBtns = predictionDiv.querySelectorAll('.prediction-btn');
                    predictionBtns.forEach(btn => {
                        btn.addEventListener('click', function() {
                            const predictionDiv = this.closest('.match-prediction');
                            const predictionOptions = predictionDiv.querySelector('.prediction-options');
                            const resultsDiv = predictionDiv.querySelector('.prediction-results-single');
                            
                            // Nascondi i pulsanti di scelta
                            predictionOptions.style.display = 'none';
                            
                            // Mostra i risultati
                            resultsDiv.style.display = 'block';
                            
                            const leftFill = resultsDiv.querySelector('.prediction-fill-left');
                            const rightFill = resultsDiv.querySelector('.prediction-fill-right');
                            
                            // Reset delle barre
                            leftFill.style.width = '0%';
                            rightFill.style.width = '0%';
                            leftFill.textContent = '';
                            rightFill.textContent = '';
                            
                            // Calcola le probabilità
                            const player1 = m.player1;
                            const player2 = m.player2;
                            const tournamentId = currentTournament.id;
                            
                            const player1Prob = calculateWinProbability(player1, player2, tournamentId);
                            const player2Prob = 1 - player1Prob;
                            
                            const player1Percent = Math.round(player1Prob * 100);
                            const player2Percent = 100 - player1Percent;
                            
                            // Animazione
                            let start = null;
                            const duration = 1000;
                            
                            function animate(timestamp) {
                                if (!start) start = timestamp;
                                const progress = Math.min((timestamp - start) / duration, 1);
                                
                                leftFill.style.width = `${progress * player1Percent}%`;
                                rightFill.style.width = `${progress * player2Percent}%`;
                                
                                if (progress < 1) {
                                    window.requestAnimationFrame(animate);
                                } else {
                                    leftFill.textContent = player1Percent + '%';
                                    rightFill.textContent = player2Percent + '%';
                                    
                                    leftFill.classList.add('active-shine');
                                    rightFill.classList.add('active-shine');
                                    
                                    setTimeout(() => {
                                        leftFill.classList.remove('active-shine');
                                        rightFill.classList.remove('active-shine');
                                    }, 700);
                                }
                            }
                            
                            window.requestAnimationFrame(animate);
                        });
                    });  
                }
                
                popupDetails.appendChild(matchDiv);
            });
        });
    }
});
  
  // Sostituisci il codice esistente con questo:
function setupPredictionButtons(matchDiv, m) {
    const predictionBtns = matchDiv.querySelectorAll('.prediction-btn');
    
    predictionBtns.forEach(btn => {
        // Rimuovi eventuali listener precedenti
        btn.replaceWith(btn.cloneNode(true));
        
        // Reimposta lo stato
        btn.disabled = false;
        btn.classList.remove('selected');
        
        // Aggiungi nuovo listener
        btn.addEventListener('click', function() {
            const predictionDiv = this.closest('.match-prediction');
            const resultsDiv = predictionDiv.querySelector('.prediction-results-single');
            
            // Disabilita tutti i pulsanti
            predictionDiv.querySelectorAll('.prediction-btn').forEach(b => {
                b.disabled = true;
                b.classList.remove('selected');
            });
            
            // Evidenzia il selezionato
            this.classList.add('selected');
            
            // Mostra risultati
            resultsDiv.style.display = 'block';
            
            const leftFill = resultsDiv.querySelector('.prediction-fill-left');
            const rightFill = resultsDiv.querySelector('.prediction-fill-right');
            
            // Reset animazione
            leftFill.style.width = '0%';
            rightFill.style.width = '0%';
            leftFill.textContent = '';
            rightFill.textContent = '';
            
            // Calcola probabilità
            const player1Prob = calculateWinProbability(m.player1, m.player2, currentTournament.id);
            const player1Percent = Math.round(player1Prob * 100);
            const player2Percent = 100 - player1Percent;
            
            // Animazione fluida
            animatePredictionBars(leftFill, rightFill, player1Percent, player2Percent);
        });
    });
}

function animatePredictionBars(leftFill, rightFill, player1Percent, player2Percent) {
    let start = null;
    const duration = 1000;
    
    function step(timestamp) {
        if (!start) start = timestamp;
        const progress = Math.min((timestamp - start) / duration, 1);
        
        leftFill.style.width = `${progress * player1Percent}%`;
        rightFill.style.width = `${progress * player2Percent}%`;
        
        if (progress < 1) {
            window.requestAnimationFrame(step);
        } else {
            leftFill.textContent = `${player1Percent}%`;
            rightFill.textContent = `${player2Percent}%`;
            triggerShineEffect(leftFill, rightFill);
        }
    }
    
    window.requestAnimationFrame(step);
}

function triggerShineEffect(leftFill, rightFill) {
    leftFill.classList.add('active-shine');
    rightFill.classList.add('active-shine');
    
    setTimeout(() => {
        leftFill.classList.remove('active-shine');
        rightFill.classList.remove('active-shine');
    }, 700);
}

function triggerShineEffect(leftFill, rightFill) {
    leftFill.classList.add('active-shine');
    rightFill.classList.add('active-shine');
    
    setTimeout(() => {
        leftFill.classList.remove('active-shine');
        rightFill.classList.remove('active-shine');
    }, 700);
}
  // ********** NAVIGAZIONE **********
  
  const simulatorBtn = document.getElementById('simulatorBtn');
  
  
  simulatorBtn.addEventListener('click', openSimulator);
  
  // ********** EDIZIONE SELEZIONE **********
  
  const editionSelect = document.getElementById('editionSelect');
  const headerYear = document.getElementById('header-year');
  
  editionSelect.addEventListener('change', () => {
    const year = editionSelect.value;
    headerYear.textContent = year;
    renderClassifica(year);
    renderCalendario(year);
  });
  
  // ********** INIZIALIZZAZIONE PAGINA **********
  
  renderClassifica('2025');
  renderCalendario('2025');
  renderNews();
  renderGallery();

function calculateWinProbability(player1, player2, tournamentId) {
    // 1. Probabilità base (50-50)
    let player1Prob = 0.5;
    
    // 2. Ottieni i dati dell'edizione corrente
    const currentEdition = editionsData['2025'];
    if (!currentEdition) return player1Prob;
    
    // 3. Fattore Posizione (65% di peso)
    const positionFactor = calculatePositionFactor(player1, player2);
    player1Prob += positionFactor * 0.65;
    
    // 4. Scontri diretti (25% di peso)
    const headToHeadFactor = calculateHeadToHeadFactor(player1, player2);
    player1Prob += headToHeadFactor * 0.25;
    
    // 5. Ultimi 3 match (7% di peso)
    const recentFormFactor = calculateRecentFormFactor(player1, player2);
    player1Prob += recentFormFactor * 0.07;
    
    // 6. Attività recente (3% di peso)
    const activityFactor = calculateActivityFactor(player1, player2);
    player1Prob += activityFactor * 0.03;
    
    // 7. Bonus torneo specifico
    const tournamentFactor = calculateTournamentFactor(player1, player2, tournamentId);
    player1Prob += tournamentFactor;
    
    // 8. Limiti più restrittivi (15-85%)
    player1Prob = Math.max(0.15, Math.min(0.85, player1Prob));
    
    return player1Prob;
}

// Nuova funzione basata sulle posizioni
function calculatePositionFactor(player1, player2) {
    const positions = getCurrentPositions();
    const p1Pos = positions[player1] || 5;
    const p2Pos = positions[player2] || 5;
    const posDiff = p2Pos - p1Pos;

    // Scala di impatto ottimizzata
    const POSITION_IMPACT = {
        4: 0.40, // 1° vs 5°
        3: 0.30, // 1° vs 4° o 2° vs 5°
        2: 0.20, // 1° vs 3° o 2° vs 4° o 3° vs 5°
        1: 0.10  // Match tra adiacenti
    };

    return POSITION_IMPACT[Math.abs(posDiff)] * Math.sign(posDiff) || 0;
}

// Funzione per estrarre le posizioni dalla classifica renderizzata
function getCurrentPositions() {
    const classificaContainer = document.getElementById('classifica-bars');
    if (!classificaContainer) return defaultPositions();
    
    try {
        const players = Array.from(classificaContainer.querySelectorAll('.name'))
                         .map(el => {
                             // Rimuove i punti dell'ultimo slam se presenti
                             return el.textContent.trim().replace(/ \(\+\d+\)$/, '');
                         });
        
        return players.reduce((acc, player, index) => {
            acc[player] = index + 1;
            return acc;
        }, {});
    } catch (error) {
        console.error("Errore nel parsing della classifica:", error);
    }
}

// Fallback se la classifica non è disponibile

function calculateHeadToHeadFactor(player1, player2) {
    // Conta tutti i match tra i due giocatori (tornei + amichevoli)
    let p1Wins = 0;
    let totalMatches = 0;
    
    // Controlla nei tornei
    Object.values(editionsData).forEach(edition => {
        edition.tournaments.forEach(t => {
            [...t.phaseGironi, ...t.phaseTabellone].forEach(phase => {
                phase.matches.forEach(m => {
                    if ((m.player1 === player1 && m.player2 === player2) || 
                        (m.player1 === player2 && m.player2 === player1)) {
                        totalMatches++;
                        if (m.winner === player1) p1Wins++;
                    }
                });
            });
        });
    });
    
    // Controlla nelle amichevoli
    friendlyMatches.forEach(m => {
        if ((m.player1 === player1 && m.player2 === player2) || 
            (m.player1 === player2 && m.player2 === player1)) {
            totalMatches++;
            if (m.winner === player1) p1Wins++;
        }
    });
    
    if (totalMatches === 0) return 0;
    
    const winRatio = p1Wins / totalMatches;
    // Normalizza tra -0.15 e 0.15 (15% di impatto massimo)
    return (winRatio - 0.5) * 0.3;
}

function calculateRecentFormFactor(player1, player2) {
    // Raccogli tutti i match dei due giocatori
    const allMatches = [];
    
    // Match dei tornei
    Object.values(editionsData).forEach(edition => {
        edition.tournaments.forEach(t => {
            [...t.phaseGironi, ...t.phaseTabellone].forEach(phase => {
                phase.matches.forEach(m => {
                    if (m.player1 === player1 || m.player2 === player1 || 
                        m.player1 === player2 || m.player2 === player2) {
                        allMatches.push({
                            ...m,
                            date: new Date(m.date.split('/').reverse().join('-')),
                            type: 'tournament'
                        });
                    }
                });
            });
        });
    });
    
    // Match amichevoli
    friendlyMatches.forEach(m => {
        if (m.player1 === player1 || m.player2 === player1 || 
            m.player1 === player2 || m.player2 === player2) {
            allMatches.push({
                ...m,
                date: new Date(m.date.split('/').reverse().join('-')),
                type: 'friendly'
            });
        }
    });
    
    // Ordina per data (dal più recente)
    allMatches.sort((a, b) => b.date - a.date);
    
    // Prendi gli ultimi 3 match di ogni giocatore
    const p1RecentMatches = allMatches.filter(m => 
        m.player1 === player1 || m.player2 === player1).slice(0, 3);
    const p2RecentMatches = allMatches.filter(m => 
        m.player1 === player2 || m.player2 === player2).slice(0, 3);
    
    // Calcola percentuale di vittorie negli ultimi 3 match
    const p1RecentWins = p1RecentMatches.filter(m => m.winner === player1).length;
    const p2RecentWins = p2RecentMatches.filter(m => m.winner === player2).length;
    
    const p1WinRatio = p1RecentMatches.length > 0 ? p1RecentWins / p1RecentMatches.length : 0.5;
    const p2WinRatio = p2RecentMatches.length > 0 ? p2RecentWins / p2RecentMatches.length : 0.5;
    
    // Normalizza tra -0.1 e 0.1 (10% di impatto massimo)
    return ((p1WinRatio - p2WinRatio) * 0.2);
}

function calculateActivityFactor(player1, player2) {
    const now = new Date();
    const oneMonthAgo = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
    
    // Controlla se i giocatori hanno giocato nell'ultimo mese
    let p1Active = false;
    let p2Active = false;
    
    // Controlla nei tornei
    Object.values(editionsData).forEach(edition => {
        edition.tournaments.forEach(t => {
            [...t.phaseGironi, ...t.phaseTabellone].forEach(phase => {
                phase.matches.forEach(m => {
                    const matchDate = new Date(m.date.split('/').reverse().join('-'));
                    if (matchDate >= oneMonthAgo) {
                        if (m.player1 === player1 || m.player2 === player1) p1Active = true;
                        if (m.player1 === player2 || m.player2 === player2) p2Active = true;
                    }
                });
            });
        });
    });
    
    // Controlla nelle amichevoli
    friendlyMatches.forEach(m => {
        const matchDate = new Date(m.date.split('/').reverse().join('-'));
        if (matchDate >= oneMonthAgo) {
            if (m.player1 === player1 || m.player2 === player1) p1Active = true;
            if (m.player1 === player2 || m.player2 === player2) p2Active = true;
        }
    });
    
    // Calcola il fattore (5% bonus per giocatore attivo)
    let factor = 0;
    if (p1Active && !p2Active) factor = 0.05;
    if (!p1Active && p2Active) factor = -0.05;
    
    return factor;
}

function calculateTournamentFactor(player1, player2, tournamentId) {
    // Bonus specifici per torneo (puoi personalizzare)
    switch(tournamentId) {
        case 'theSinner':
            // Esempio: Gioxter ha vinto il primo torneo, bonus per lui
            if (player1 === 'Gioxter') return 0.03;
            if (player2 === 'Gioxter') return -0.03;
            break;
        case 'heatCup':
            // Nessun bonus specifico per ora
            break;
        case 'orangeTournament':
            // Nessun bonus specifico per ora
            break;
        case 'snowSlam':
            // Nessun bonus specifico per ora
            break;
    }
    
    return 0;
}
</script>

</body>
</html>